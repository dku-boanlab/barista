<html>
<head>
<title>cbench/oflops/cbench/fakeswitch.h</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/1100.html'>cbench</a>/<a href='../files/1101.html'>oflops</a>/<a href='../files/1102.html'>cbench</a>/fakeswitch.h</h2>
<i><font color='green'>/* [&lt;][&gt;][^][v][top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2><a href='../J/19.html' title='Multiple included from 2 places.'>INCLUDED FROM</a></h2>
<hr>
<pre>
<a name='L1'>   1 <font color='darkred'>#ifndef</font> <a href='../S/24.html#L2' title='Defined at 2 in cbench/oflops/cbench/fakeswitch.h.'>FAKESWITCH_H</a>
<a name='L2'>   2 <font color='darkred'>#define</font> <a href='../S/24.html#L1' title='Refered from 1 in cbench/oflops/cbench/fakeswitch.h.'>FAKESWITCH_H</a>
<a name='L3'>   3 
<a name='L4'>   4 <font color='darkred'>#include</font> &lt;poll.h&gt;
<a name='L5'>   5 
<a name='L6'>   6 <font color='darkred'>#include</font> "<a href='54.html'>msgbuf.h</a>"
<a name='L7'>   7 
<a name='L8'>   8 <font color='darkred'>#define</font> <a href='../S/28.html#L504' title='Refered from 504 in cbench/oflops/cbench/fakeswitch.c.'>NUM_BUFFER_IDS</a> 100000
<a name='L9'>   9 
<a name='L10'>  10 <b>enum</b> <a href='../S/24.html#L28' title='Refered from 28 in cbench/oflops/cbench/fakeswitch.h.'>test_mode</a> 
<a name='L11'>  11 <font color='red'>{</font>
<a name='L12'>  12     <a href='../Y/544.html' title='Multiple used in 5 places.'>MODE_LATENCY</a>, <a href='../Y/545.html' title='Multiple used in 5 places.'>MODE_THROUGHPUT</a>
<a name='L13'>  13 <font color='red'>}</font>;
<a name='L14'>  14 
<a name='L15'>  15 <b>enum</b> handshake_status <font color='red'>{</font>
<a name='L16'>  16     <a href='../S/28.html#L76' title='Refered from 76 in cbench/oflops/cbench/fakeswitch.c.'>START</a> = 0,
<a name='L17'>  17     <a href='../R/760.html' title='Multiple refered from 2 places.'>LEARN_DSTMAC</a> = 2,
<a name='L18'>  18     <a href='../R/1515.html' title='Multiple refered from 6 places.'>READY_TO_SEND</a> = 99,
<a name='L19'>  19     <a href='../R/1743.html' title='Multiple refered from 2 places.'>WAITING</a> = 101
<a name='L20'>  20 <font color='red'>}</font>;
<a name='L21'>  21     
<a name='L22'>  22 <b>struct</b> <a href='../R/3004.html' title='Multiple refered from 2 places.'>fakeswitch</a> 
<a name='L23'>  23 <font color='red'>{</font>
<a name='L24'>  24     <b>int</b> <a href='../Y/3709.html' title='Multiple used in 808 places.'>id</a>;                             <i><font color='green'>// switch number</font></i>
<a name='L25'>  25     <b>int</b> <a href='../Y/2294.html' title='Multiple used in 13 places.'>debug</a>;                          <i><font color='green'>// do we print debug msgs?</font></i>
<a name='L26'>  26     <b>int</b> <a href='../Y/6894.html' title='Multiple used in 148 places.'>sock</a>;
<a name='L27'>  27     <b>struct</b> <a href='../S/54.html#L4' title='Defined at 4 in cbench/oflops/msgbuf.h.'>msgbuf</a> * <a href='../Y/3789.html' title='Multiple used in 9 places.'>inbuf</a>, * <a href='../Y/5553.html' title='Multiple used in 15 places.'>outbuf</a>;    <i><font color='green'>// input,output buffers</font></i>
<a name='L28'>  28     <b>enum</b> <a href='../S/24.html#L10' title='Defined at 10 in cbench/oflops/cbench/fakeswitch.h.'>test_mode</a> <a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>;                <i><font color='green'>// are we going for latency or throughput?</font></i>
<a name='L29'>  29     <b>int</b> <a href='../Y/5926.html' title='Multiple used in 16 places.'>probe_state</a>;                    <i><font color='green'>// if mode=LATENCY, this is a flag: do we have a packet outstanding?</font></i>
<a name='L30'>  30                                         <i><font color='green'>// if mode=THROUGHPUT, this is the number of outstanding probes</font></i>
<a name='L31'>  31     <b>int</b> <a href='../Y/2142.html' title='Multiple used in 329 places.'>count</a>;                          <i><font color='green'>// number of response's received</font></i>
<a name='L32'>  32     <b>int</b> <a href='../S/805.html#L57' title='Defined at 57 in cbench/openflow/secchan/status.c.'>switch_status</a>;                  <i><font color='green'>// are we ready to start sending packet_in's?</font></i>
<a name='L33'>  33     <b>int</b> <a href='../Y/4819.html' title='Multiple used in 4 places.'>next_status</a>;                    <i><font color='green'>// if we are waiting, next step to go after delay expires</font></i>
<a name='L34'>  34     <b>int</b> <a href='../Y/5924.html' title='Multiple used in 3 places.'>probe_size</a>;                     <i><font color='green'>// how big is the probe (for buffer tuning)</font></i>
<a name='L35'>  35     <b>int</b> <a href='../Y/2314.html' title='Multiple used in 90 places.'>delay</a>;                          <i><font color='green'>// delay between state changes</font></i>
<a name='L36'>  36     <b>int</b> <a href='../Y/7997.html' title='Multiple used in 182 places.'>xid</a>;
<a name='L37'>  37     <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a>  <a href='../Y/2318.html' title='Multiple used in 5 places.'>delay_start</a>;        <i><font color='green'>// when did the current delay start - valid if in waiting state</font></i>
<a name='L38'>  38     <b>int</b> <a href='../Y/7438.html' title='Multiple used in 10 places.'>total_mac_addresses</a>;
<a name='L39'>  39     <b>int</b> <a href='../Y/2233.html' title='Multiple used in 5 places.'>current_mac_address</a>;
<a name='L40'>  40     <b>int</b> <a href='../Y/4110.html' title='Multiple used in 5 places.'>learn_dstmac</a>;
<a name='L41'>  41     <b>int</b> <a href='../Y/2230.html' title='Multiple used in 4 places.'>current_buffer_id</a>;
<a name='L42'>  42 <font color='red'>}</font>;
<a name='L43'>  43 
<a name='L44'>  44 <i><font color='green'>/*** Initialize an already allocated fakeswitch</font></i>
<a name='L45'>  45 <i><font color='green'> * Fill in all of the parameters, </font></i>
<a name='L46'>  46 <i><font color='green'> *  exchange OFP_HELLO, block waiting on features_request</font></i>
<a name='L47'>  47 <i><font color='green'> *  and send features reply</font></i>
<a name='L48'>  48 <i><font color='green'> * @param fs        Pointer to a fakeswitch</font></i>
<a name='L49'>  49 <i><font color='green'> * @param sock      A non-blocking socket already connected to </font></i>
<a name='L50'>  50 <i><font color='green'> *                          the controller (will be non-blocking on return)</font></i>
<a name='L51'>  51 <i><font color='green'> * @param bufsize   The initial in and out buffer size</font></i>
<a name='L52'>  52 <i><font color='green'> * @param mode      Should we test throughput or latency?</font></i>
<a name='L53'>  53 <i><font color='green'> * @param total_mac_addresses      The total number of unique mac addresses</font></i>
<a name='L54'>  54 <i><font color='green'> *                                 to use for packet ins from this switch</font></i>
<a name='L55'>  55 <i><font color='green'> */</font></i>
<a name='L56'>  56 <b>void</b> <a href='../S/28.html#L58' title='Defined at 58 in cbench/oflops/cbench/fakeswitch.c.'>fakeswitch_init</a>(<b>struct</b> <a href='../Y/2995.html' title='Multiple used in 20 places.'>fakeswitch</a> *<a href='../Y/3256.html' title='Multiple used in 160 places.'>fs</a>, <b>int</b> <a href='../Y/2531.html' title='Multiple used in 319 places.'>dpid</a>, <b>int</b> <a href='../Y/6894.html' title='Multiple used in 148 places.'>sock</a>, <b>int</b> <a href='../Y/1715.html' title='Multiple used in 17 places.'>bufsize</a>, <b>int</b> <a href='../Y/2294.html' title='Multiple used in 13 places.'>debug</a>, <b>int</b> <a href='../Y/2314.html' title='Multiple used in 90 places.'>delay</a>, <b>enum</b> <a href='../Y/7313.html' title='Multiple used in 2 places.'>test_mode</a> <a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>, <b>int</b> <a href='../Y/7438.html' title='Multiple used in 10 places.'>total_mac_addresses</a>, <b>int</b> <a href='../Y/4110.html' title='Multiple used in 5 places.'>learn_dstmac</a>);
<a name='L57'>  57 
<a name='L58'>  58 <i><font color='green'>/*** Set the desired flags for poll()</font></i>
<a name='L59'>  59 <i><font color='green'> * @param fs    Pointer to initalized fakeswitch</font></i>
<a name='L60'>  60 <i><font color='green'> * @param pfd   Pointer to an allocated poll structure</font></i>
<a name='L61'>  61 <i><font color='green'> */</font></i>
<a name='L62'>  62 <b>void</b> <a href='../S/28.html#L151' title='Defined at 151 in cbench/oflops/cbench/fakeswitch.c.'>fakeswitch_set_pollfd</a>(<b>struct</b> <a href='../Y/2995.html' title='Multiple used in 20 places.'>fakeswitch</a> *<a href='../Y/3256.html' title='Multiple used in 160 places.'>fs</a>, <b>struct</b> <a href='../Y/5784.html' title='Multiple used in 34 places.'>pollfd</a> *<a href='../Y/5723.html' title='Multiple used in 29 places.'>pfd</a>);
<a name='L63'>  63 
<a name='L64'>  64 <i><font color='green'>/*** Call back to call on poll()</font></i>
<a name='L65'>  65 <i><font color='green'> *  If POLLOUT and not packet_sent, send a packet, set packet_sent</font></i>
<a name='L66'>  66 <i><font color='green'> *  If POLLIN, read it</font></i>
<a name='L67'>  67 <i><font color='green'> *      if the message is not complete, return</font></i>
<a name='L68'>  68 <i><font color='green'> *      if it's an echo request, then reply</font></i>
<a name='L69'>  69 <i><font color='green'> *      if it's a flow_mod, then incremenet count</font></i>
<a name='L70'>  70 <i><font color='green'> *      else ignore it</font></i>
<a name='L71'>  71 <i><font color='green'> * @param fs    Pointer to initalized fakeswitch</font></i>
<a name='L72'>  72 <i><font color='green'> * @param pfd   Pointer to an allocated poll structure or the number of events as int</font></i>
<a name='L73'>  73 <i><font color='green'> */</font></i>
<a name='L74'>  74 <b>void</b> <a href='../S/28.html#L528' title='Defined at 528 in cbench/oflops/cbench/fakeswitch.c.'>fakeswitch_handle_io</a>(<b>struct</b> <a href='../Y/2995.html' title='Multiple used in 20 places.'>fakeswitch</a> *<a href='../Y/3256.html' title='Multiple used in 160 places.'>fs</a>, <b>void</b>* <a href='../Y/5724.html' title='Multiple used in 4 places.'>pfd_events</a>);
<a name='L75'>  75 <i><font color='green'>/**** Get and reset count </font></i>
<a name='L76'>  76 <i><font color='green'> * @param fs    Pointer to initialized fakeswitch</font></i>
<a name='L77'>  77 <i><font color='green'> * @return      Number of flow_mod responses since last call</font></i>
<a name='L78'>  78 <i><font color='green'> */</font></i>
<a name='L79'>  79 <b>int</b> <a href='../S/28.html#L159' title='Defined at 159 in cbench/oflops/cbench/fakeswitch.c.'>fakeswitch_get_count</a>(<b>struct</b> <a href='../Y/2995.html' title='Multiple used in 20 places.'>fakeswitch</a> *<a href='../Y/3256.html' title='Multiple used in 160 places.'>fs</a>);
<a name='L80'>  80 
<a name='L81'>  81 <font color='darkred'>#endif</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;][^][v]<a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
