<html>
<head>
<title>cbench/oflops/example_modules/openflow_port_status/portstat.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/1100.html'>cbench</a>/<a href='../files/1101.html'>oflops</a>/<a href='../files/1103.html'>example_modules</a>/<a href='../files/1118.html'>openflow_port_status</a>/portstat.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L79'>[^]</a><a href='#L245'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L79' title='Defined at 79.'>name</a>
<li><a href='#L84' title='Defined at 84.'>new_rate</a>
<li><a href='#L128' title='Defined at 128.'>start</a>
<li><a href='#L162' title='Defined at 162.'>handle_timer_event</a>
<li><a href='#L220' title='Defined at 220.'>of_event_packet_in</a>
<li><a href='#L231' title='Defined at 231.'>get_pcap_filter</a>
<li><a href='#L245' title='Defined at 245.'>handle_pcap_event</a>
</ol>
<hr>
<pre>
<a name='L1'>   1 <font color='darkred'>#include</font> &lt;assert.h&gt;
<a name='L2'>   2 <font color='darkred'>#include</font> &lt;stdio.h&gt;
<a name='L3'>   3 <font color='darkred'>#include</font> &lt;stdlib.h&gt;
<a name='L4'>   4 <font color='darkred'>#include</font> &lt;string.h&gt;
<a name='L5'>   5 
<a name='L6'>   6 <font color='darkred'>#include</font> &lt;sys/socket.h&gt;
<a name='L7'>   7 <font color='darkred'>#include</font> &lt;<a href='315.html'>sys/types.h</a>&gt;
<a name='L8'>   8 <font color='darkred'>#include</font> &lt;sys/time.h&gt;
<a name='L9'>   9 
<a name='L10'>  10 <font color='darkred'>#include</font> &lt;arpa/inet.h&gt;
<a name='L11'>  11 
<a name='L12'>  12 <font color='darkred'>#include</font> &lt;<a href='55.html'>test_module.h</a>&gt;
<a name='L13'>  13 
<a name='L14'>  14 <font color='darkred'>#define</font> <a href='../R/1383.html' title='Multiple refered from 6 places.'>PACKET_IN_DEBUG</a> 0
<a name='L15'>  15 
<a name='L16'>  16 <i><font color='green'>/** Interval to send packet</font></i>
<a name='L17'>  17 <i><font color='green'> */</font></i>
<a name='L18'>  18 <i><font color='green'>//#define MIN_SEND_INTERVAL 500000</font></i>
<a name='L19'>  19 <i><font color='green'>//#define MIN_SEND_INTERVAL 2000</font></i>
<a name='L20'>  20 <b>int</b> min_send_interval= 2000;
<a name='L21'>  21 
<a name='L22'>  22 <i><font color='green'>/** String for scheduling events</font></i>
<a name='L23'>  23 <i><font color='green'> */</font></i>
<a name='L24'>  24 <font color='darkred'>#define</font> <a href='../R/970.html' title='Multiple refered from 3 places.'>NEWRATE</a> "newrate"
<a name='L25'>  25 <font color='darkred'>#define</font> <a href='../R/1773.html' title='Multiple refered from 6 places.'>WRITEPACKET</a> "write packet"
<a name='L26'>  26 
<a name='L27'>  27 <b>typedef</b> <b>struct</b> <a href='../R/4138.html' title='Multiple refered from 4 places.'>probe</a> <font color='red'>{</font>
<a name='L28'>  28         <b>int</b> <a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>;
<a name='L29'>  29         <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a> <a href='../Y/6665.html' title='Multiple used in 6 places.'>sent</a>;
<a name='L30'>  30 <font color='red'>}</font> <a href='../R/4138.html' title='Multiple refered from 4 places.'>probe</a>;
<a name='L31'>  31 
<a name='L32'>  32 <font color='darkred'>#ifndef</font> <a href='../D/520.html' title='Multiple defined in 7 places.'>BUFLEN</a>
<a name='L33'>  33 <font color='darkred'>#define</font> <a href='../R/156.html' title='Multiple refered from 36 places.'>BUFLEN</a> 4096
<a name='L34'>  34 <font color='darkred'>#endif</font>
<a name='L35'>  35 
<a name='L36'>  36 <font color='darkred'>#define</font> <a href='../R/885.html' title='Multiple refered from 4 places.'>MAX_OUTSTANDING</a> 65536
<a name='L37'>  37 <a href='../D/9166.html' title='Multiple defined in 2 places.'>probe</a> <a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>[<a href='../S/79.html#L36' title='Defined at 36 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>MAX_OUTSTANDING</a>];
<a name='L38'>  38 
<a name='L39'>  39 
<a name='L40'>  40 <b>int</b> <a href='../Y/5929.html' title='Multiple used in 6 places.'>probes_per_second</a>=1;
<a name='L41'>  41 <b>int</b> <a href='../Y/6630.html' title='Multiple used in 3 places.'>seconds_per_rate</a>=5;
<a name='L42'>  42 <b>int</b> <a href='../Y/4384.html' title='Multiple used in 2 places.'>max_rate</a>=1024;
<a name='L43'>  43 <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a> <a href='../Y/7000.html' title='Multiple used in 5 places.'>starttime</a>, <a href='../Y/2686.html' title='Multiple used in 6 places.'>end_time</a>;
<a name='L44'>  44 
<a name='L45'>  45 <i><font color='green'>/** OpenFlow packet buffer</font></i>
<a name='L46'>  46 <i><font color='green'> */</font></i>
<a name='L47'>  47 <b>struct</b> <a href='../D/8898.html' title='Multiple defined in 3 places.'>ofp_stats_request</a> <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>;
<a name='L48'>  48 
<a name='L49'>  49 <i><font color='green'>/** index of next probe</font></i>
<a name='L50'>  50 <i><font color='green'> */</font></i>
<a name='L51'>  51 <b>int</b> <a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>=0;
<a name='L52'>  52 <i><font color='green'>/** Send counter</font></i>
<a name='L53'>  53 <i><font color='green'> */</font></i>
<a name='L54'>  54 <a href='../Y/7623.html' title='Multiple used in 568 places.'>uint64_t</a> <a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a> = 0;
<a name='L55'>  55 <a href='../Y/7623.html' title='Multiple used in 568 places.'>uint64_t</a> <a href='../Y/5682.html' title='Multiple used in 2 places.'>pcap_sentcounter</a> = 0;
<a name='L56'>  56 <i><font color='green'>/** Receive counter</font></i>
<a name='L57'>  57 <i><font color='green'> */</font></i>
<a name='L58'>  58 <a href='../Y/7623.html' title='Multiple used in 568 places.'>uint64_t</a> <a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a> = 0;
<a name='L59'>  59 <i><font color='green'>/** Total delay</font></i>
<a name='L60'>  60 <i><font color='green'> */</font></i>
<a name='L61'>  61 <i><font color='green'>/** Delay packet counter</font></i>
<a name='L62'>  62 <i><font color='green'> */</font></i>
<a name='L63'>  63 <a href='../Y/7623.html' title='Multiple used in 568 places.'>uint64_t</a> <a href='../Y/7442.html' title='Multiple used in 3 places.'>totaldelay</a> = 0;
<a name='L64'>  64 <i><font color='green'>/** Delay file</font></i>
<a name='L65'>  65 <i><font color='green'> */</font></i>
<a name='L66'>  66 <a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a>* <a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a> =<a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>;
<a name='L67'>  67 
<a name='L68'>  68 <i><font color='green'>/** @ingroup modules</font></i>
<a name='L69'>  69 <i><font color='green'> * Packet in module.</font></i>
<a name='L70'>  70 <i><font color='green'> * The module sends packet into a port to generate packet-in events.</font></i>
<a name='L71'>  71 <i><font color='green'> * The rate, count and delay then determined.</font></i>
<a name='L72'>  72 <i><font color='green'> *</font></i>
<a name='L73'>  73 <i><font color='green'> * Copyright (C) Stanford University, 2009</font></i>
<a name='L74'>  74 <i><font color='green'> * @author ykk</font></i>
<a name='L75'>  75 <i><font color='green'> * @date September, 2009</font></i>
<a name='L76'>  76 <i><font color='green'> * </font></i>
<a name='L77'>  77 <i><font color='green'> * @return name of module</font></i>
<a name='L78'>  78 <i><font color='green'> */</font></i>
<a name='L79'>  79 <b>char</b> * <a href='../R/3559.html' title='Multiple refered from 876 places.'>name</a>()
<a name='L80'>  80 <font color='red'>{</font>
<a name='L81'>  81         <b>return</b> "port_status_module";
<a name='L82'>  82 <font color='red'>}</font>
<a name='L83'>  83 
<a name='L84'>  84 <b>void</b> <a href='../S/79.html#L209' title='Refered from 209 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>new_rate</a>(<a href='../Y/5077.html' title='Multiple used in 258 places.'>oflops_context</a> * <a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>)     <i><font color='green'>// worst side effect evar</font></i>
<a name='L85'>  85 <font color='red'>{</font>
<a name='L86'>  86         <b>char</b> <a href='../Y/3009.html' title='Multiple used in 3 places.'>fbuf</a>[<a href='../D/520.html' title='Multiple defined in 7 places.'>BUFLEN</a>];
<a name='L87'>  87         <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a> <a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>;
<a name='L88'>  88         <b>int</b> <a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>;
<a name='L89'>  89 
<a name='L90'>  90         <b>if</b>(<a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a>)   
<a name='L91'>  91         <font color='red'>{</font>
<a name='L92'>  92                 <b>for</b>(<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>=0;<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>&lt;<a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>;<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>++)
<a name='L93'>  93                 <font color='red'>{</font>
<a name='L94'>  94                         <b>if</b>(<a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>[<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>)    <i><font color='green'>// expire unreturned probes</font></i>
<a name='L95'>  95                                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a>,"%d -1\n",<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>);
<a name='L96'>  96                 <font color='red'>}</font>
<a name='L97'>  97                 <a href='../Y/3012.html' title='Multiple used in 34 places.'>fclose</a>(<a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a>);
<a name='L98'>  98         <font color='red'>}</font>
<a name='L99'>  99         <a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>=0;
<a name='L100'> 100         <a href='../Y/5929.html' title='Multiple used in 6 places.'>probes_per_second</a>*=2;
<a name='L101'> 101 
<a name='L102'> 102         <b>if</b>(<a href='../Y/5929.html' title='Multiple used in 6 places.'>probes_per_second</a> &gt; <a href='../Y/4384.html' title='Multiple used in 2 places.'>max_rate</a>)
<a name='L103'> 103         <font color='red'>{</font>
<a name='L104'> 104                 <a href='../Y/3429.html' title='Multiple used in 133 places.'>gettimeofday</a>(&amp;<a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>,<a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>);
<a name='L105'> 105                 <i><font color='green'>//End experiment</font></i>
<a name='L106'> 106                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Experiment has %lld packets sent and %lld received -- %f dropped",
<a name='L107'> 107                         (<b>long</b> <b>long</b> <b>int</b>)<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>, (<b>long</b> <b>long</b> <b>int</b>)<a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a> , 
<a name='L108'> 108                         (<b>long</b> <b>long</b> <b>int</b>)(<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>-<a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a>)/(<b>float</b>)<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>);
<a name='L109'> 109                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, " (i.e., loss = %lld) with average delay of %f us.\n", 
<a name='L110'> 110                                 (<b>long</b> <b>long</b> <b>int</b>)(<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>-<a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a>),
<a name='L111'> 111                                 ((<b>float</b>) ((<b>double</b>) <a href='../Y/7442.html' title='Multiple used in 3 places.'>totaldelay</a>)/((<b>double</b>) <a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a>)));
<a name='L112'> 112                 <a href='../S/121.html#L27' title='Defined at 27 in cbench/oflops/test_module.c.'>oflops_end_test</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,1);
<a name='L113'> 113                 <b>return</b>;
<a name='L114'> 114         <font color='red'>}</font>
<a name='L115'> 115         <i><font color='green'>//Open delay file</font></i>
<a name='L116'> 116         <a href='../Y/6891.html' title='Multiple used in 224 places.'>snprintf</a>(<a href='../Y/3009.html' title='Multiple used in 3 places.'>fbuf</a>,<a href='../D/520.html' title='Multiple defined in 7 places.'>BUFLEN</a>,"statdelayfile.rate=%d",<a href='../Y/5929.html' title='Multiple used in 6 places.'>probes_per_second</a>);
<a name='L117'> 117         <a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a> = <a href='../Y/3190.html' title='Multiple used in 43 places.'>fopen</a>(<a href='../Y/3009.html' title='Multiple used in 3 places.'>fbuf</a>, "w+");
<a name='L118'> 118         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>,"---- Sending port_stats_requests at rate %d per second for %d seconds\n", <a href='../Y/5929.html' title='Multiple used in 6 places.'>probes_per_second</a>, <a href='../Y/6630.html' title='Multiple used in 3 places.'>seconds_per_rate</a>);
<a name='L119'> 119         <a href='../Y/3429.html' title='Multiple used in 133 places.'>gettimeofday</a>(&amp;<a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>,<a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>);
<a name='L120'> 120         <a href='../Y/2686.html' title='Multiple used in 6 places.'>end_time</a> = <a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>;
<a name='L121'> 121         <a href='../Y/2686.html' title='Multiple used in 6 places.'>end_time</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a> += <a href='../Y/6630.html' title='Multiple used in 3 places.'>seconds_per_rate</a>;
<a name='L122'> 122         <a href='../S/121.html#L94' title='Defined at 94 in cbench/oflops/test_module.c.'>oflops_schedule_timer_event</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,&amp;<a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>, <a href='../D/5992.html' title='Multiple defined in 7 places.'>WRITEPACKET</a>);
<a name='L123'> 123 <font color='red'>}</font>
<a name='L124'> 124 
<a name='L125'> 125 <i><font color='green'>/** Initialization</font></i>
<a name='L126'> 126 <i><font color='green'> * @param ctx pointer to opaque context</font></i>
<a name='L127'> 127 <i><font color='green'> */</font></i>
<a name='L128'> 128 <b>int</b> <a href='../R/4512.html' title='Multiple refered from 167 places.'>start</a>(<b>struct</b> <a href='../Y/5077.html' title='Multiple used in 258 places.'>oflops_context</a> * <a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>)
<a name='L129'> 129 <font color='red'>{</font>
<a name='L130'> 130         <b>struct</b> <a href='../D/8801.html' title='Multiple defined in 3 places.'>ofp_header</a> <a href='../Y/5378.html' title='Multiple used in 178 places.'>ofph</a>;
<a name='L131'> 131         <a href='../Y/3429.html' title='Multiple used in 133 places.'>gettimeofday</a>(&amp;<a href='../Y/7000.html' title='Multiple used in 5 places.'>starttime</a>,<a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>);
<a name='L132'> 132         <a href='../Y/7000.html' title='Multiple used in 5 places.'>starttime</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a> += 10;
<a name='L133'> 133 
<a name='L134'> 134         <a href='../Y/1748.html' title='Multiple used in 31 places.'>bzero</a>(<a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>,<b>sizeof</b>(<a href='../D/9166.html' title='Multiple defined in 2 places.'>probe</a>)*<a href='../S/79.html#L36' title='Defined at 36 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>MAX_OUTSTANDING</a>);
<a name='L135'> 135 
<a name='L136'> 136         
<a name='L137'> 137         <a href='../S/121.html#L94' title='Defined at 94 in cbench/oflops/test_module.c.'>oflops_schedule_timer_event</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,&amp;<a href='../Y/7000.html' title='Multiple used in 5 places.'>starttime</a>, <a href='../S/79.html#L24' title='Defined at 24 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>NEWRATE</a>);
<a name='L138'> 138         <i><font color='green'>//Schedule first event</font></i>
<a name='L139'> 139 
<a name='L140'> 140         <i><font color='green'>// send a friendly hello</font></i>
<a name='L141'> 141         <a href='../Y/5378.html' title='Multiple used in 178 places.'>ofph</a>.<a href='../Y/4125.html' title='Multiple used in 540 places.'>length</a> = <a href='../Y/3678.html' title='Multiple used in 586 places.'>htons</a>(<b>sizeof</b>(<b>struct</b> <a href='../D/8801.html' title='Multiple defined in 3 places.'>ofp_header</a>));
<a name='L142'> 142         <a href='../Y/5378.html' title='Multiple used in 178 places.'>ofph</a>.<a href='../Y/7997.html' title='Multiple used in 182 places.'>xid</a> = 0;
<a name='L143'> 143         <a href='../Y/5378.html' title='Multiple used in 178 places.'>ofph</a>.<a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> = <a href='../D/3675.html' title='Multiple defined in 3 places.'>OFPT_HELLO</a>;
<a name='L144'> 144         <a href='../Y/5378.html' title='Multiple used in 178 places.'>ofph</a>.<a href='../Y/7770.html' title='Multiple used in 173 places.'>version</a> = <a href='../Y/621.html' title='Multiple used in 78 places.'>OFP_VERSION</a>;
<a name='L145'> 145         <a href='../S/121.html#L119' title='Defined at 119 in cbench/oflops/test_module.c.'>oflops_send_of_mesg</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,&amp;<a href='../Y/5378.html' title='Multiple used in 178 places.'>ofph</a>);
<a name='L146'> 146 
<a name='L147'> 147         <i><font color='green'>// build port stat request</font></i>
<a name='L148'> 148         <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/3593.html' title='Multiple used in 234 places.'>header</a>.<a href='../Y/4125.html' title='Multiple used in 540 places.'>length</a> = <a href='../Y/3678.html' title='Multiple used in 586 places.'>htons</a>(<b>sizeof</b>(<b>struct</b> <a href='../D/8898.html' title='Multiple defined in 3 places.'>ofp_stats_request</a>));
<a name='L149'> 149         <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/3593.html' title='Multiple used in 234 places.'>header</a>.<a href='../Y/7997.html' title='Multiple used in 182 places.'>xid</a> = 0;
<a name='L150'> 150         <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/3593.html' title='Multiple used in 234 places.'>header</a>.<a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> = <a href='../D/3694.html' title='Multiple defined in 2 places.'>OFPT_STATS_REQUEST</a>;
<a name='L151'> 151         <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/3593.html' title='Multiple used in 234 places.'>header</a>.<a href='../Y/7770.html' title='Multiple used in 173 places.'>version</a> = <a href='../Y/621.html' title='Multiple used in 78 places.'>OFP_VERSION</a>;
<a name='L152'> 152         <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> = <a href='../Y/3678.html' title='Multiple used in 586 places.'>htons</a>(<a href='../D/3624.html' title='Multiple defined in 2 places.'>OFPST_PORT</a>);
<a name='L153'> 153         <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/3119.html' title='Multiple used in 292 places.'>flags</a> = 0;
<a name='L154'> 154 
<a name='L155'> 155         <b>return</b> 0;
<a name='L156'> 156 <font color='red'>}</font>
<a name='L157'> 157 
<a name='L158'> 158 <i><font color='green'>/** Handle timer event</font></i>
<a name='L159'> 159 <i><font color='green'> * @param ctx pointer to opaque context</font></i>
<a name='L160'> 160 <i><font color='green'> * @param te pointer to timer event</font></i>
<a name='L161'> 161 <i><font color='green'> */</font></i>
<a name='L162'> 162 <b>int</b> <a href='../R/3193.html' title='Multiple refered from 3 places.'>handle_timer_event</a>(<b>struct</b> <a href='../Y/5077.html' title='Multiple used in 258 places.'>oflops_context</a> * <a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>, <b>struct</b> <a href='../Y/7377.html' title='Multiple used in 19 places.'>timer_event</a> *<a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>)
<a name='L163'> 163 <font color='red'>{</font>
<a name='L164'> 164         <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a> <a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>;
<a name='L165'> 165         <b>char</b> * <a href='../Y/7069.html' title='Multiple used in 188 places.'>str</a>;
<a name='L166'> 166 
<a name='L167'> 167         <a href='../Y/3429.html' title='Multiple used in 133 places.'>gettimeofday</a>(&amp;<a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>,<a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>);
<a name='L168'> 168         <a href='../Y/7069.html' title='Multiple used in 188 places.'>str</a> = (<b>char</b> *) <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/1454.html' title='Multiple used in 77 places.'>arg</a>;
<a name='L169'> 169         <b>if</b> (<a href='../S/79.html#L14' title='Defined at 14 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>PACKET_IN_DEBUG</a>)
<a name='L170'> 170                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "At %ld.%.6ld (sched for %ld.%.6ld) : Got timer_event %s \n",
<a name='L171'> 171                                 <a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/4938.html' title='Multiple used in 566 places.'>now</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>, <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>, <a href='../Y/7069.html' title='Multiple used in 188 places.'>str</a>);
<a name='L172'> 172 
<a name='L173'> 173         <b>if</b>(!<a href='../Y/7082.html' title='Multiple used in 371 places.'>strcmp</a>(<a href='../Y/7069.html' title='Multiple used in 188 places.'>str</a>,<a href='../D/5992.html' title='Multiple defined in 7 places.'>WRITEPACKET</a>))
<a name='L174'> 174         <font color='red'>{</font>
<a name='L175'> 175                 <i><font color='green'>//Send message</font></i>
<a name='L176'> 176                 <b>if</b> (<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a> == 0)
<a name='L177'> 177                 <font color='red'>{</font>
<a name='L178'> 178                         <a href='../Y/3429.html' title='Multiple used in 133 places.'>gettimeofday</a>(&amp;<a href='../Y/7000.html' title='Multiple used in 5 places.'>starttime</a>, <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>);
<a name='L179'> 179                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Start...\n");
<a name='L180'> 180                 <font color='red'>}</font>
<a name='L181'> 181                 <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>.<a href='../Y/3593.html' title='Multiple used in 234 places.'>header</a>.<a href='../Y/7997.html' title='Multiple used in 182 places.'>xid</a> = <a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>;
<a name='L182'> 182                 <b>if</b> (<a href='../S/79.html#L14' title='Defined at 14 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>PACKET_IN_DEBUG</a>)
<a name='L183'> 183                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Sending message %lld\n", (<b>long</b> <b>long</b> <b>int</b>)<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>);
<a name='L184'> 184                 <b>if</b>(<a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>[<a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>)
<a name='L185'> 185                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a>,"%d %d\n",<a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>, -1);
<a name='L186'> 186                 <a href='../Y/1748.html' title='Multiple used in 31 places.'>bzero</a>(&amp;<a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>[<a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>],<b>sizeof</b>(<a href='../D/9166.html' title='Multiple defined in 2 places.'>probe</a>));
<a name='L187'> 187                 <a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>[<a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>=1;
<a name='L188'> 188                 <a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a>++;
<a name='L189'> 189                 <a href='../Y/4809.html' title='Multiple used in 10 places.'>next_index</a> %= <a href='../S/79.html#L36' title='Defined at 36 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>MAX_OUTSTANDING</a>;
<a name='L190'> 190                 <a href='../S/121.html#L119' title='Defined at 119 in cbench/oflops/test_module.c.'>oflops_send_of_mesg</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,(<b>struct</b> <a href='../D/8801.html' title='Multiple defined in 3 places.'>ofp_header</a> *) &amp;<a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>);
<a name='L191'> 191                 <a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>++;
<a name='L192'> 192                 <i><font color='green'>//Schedule next one; using sched time to avoid creep</font></i>
<a name='L193'> 193                 <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a> += 1000000/<a href='../Y/5929.html' title='Multiple used in 6 places.'>probes_per_second</a>;;   
<a name='L194'> 194                 <b>if</b>(<a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a> &gt;= 1000000)
<a name='L195'> 195                 <font color='red'>{</font>
<a name='L196'> 196                         <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>++;
<a name='L197'> 197                         <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>-=1000000;
<a name='L198'> 198                 <font color='red'>}</font>
<a name='L199'> 199                 <b>if</b>(<a href='../S/21.html#L110' title='Defined at 110 in cbench/oflops/wc_event.c.'>timercmp</a>(&amp;<a href='../Y/2686.html' title='Multiple used in 6 places.'>end_time</a>, &amp;<a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>, &gt;))
<a name='L200'> 200                         <i><font color='green'>// have time to fire off another probe</font></i>
<a name='L201'> 201                         <a href='../S/121.html#L94' title='Defined at 94 in cbench/oflops/test_module.c.'>oflops_schedule_timer_event</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,&amp;<a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>, <a href='../D/5992.html' title='Multiple defined in 7 places.'>WRITEPACKET</a>);
<a name='L202'> 202                 <b>else</b>
<a name='L203'> 203                 <font color='red'>{</font>
<a name='L204'> 204                         <a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>++;        <i><font color='green'>// give some time for probes to drain</font></i>
<a name='L205'> 205                         <a href='../S/121.html#L94' title='Defined at 94 in cbench/oflops/test_module.c.'>oflops_schedule_timer_event</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>,&amp;<a href='../Y/7295.html' title='Multiple used in 60 places.'>te</a>-&gt;<a href='../Y/6607.html' title='Multiple used in 22 places.'>sched_time</a>, <a href='../S/79.html#L24' title='Defined at 24 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>NEWRATE</a>);
<a name='L206'> 206                 <font color='red'>}</font>
<a name='L207'> 207         <font color='red'>}</font>
<a name='L208'> 208         <b>else</b> <b>if</b>(!<a href='../Y/7082.html' title='Multiple used in 371 places.'>strcmp</a>(<a href='../Y/7069.html' title='Multiple used in 188 places.'>str</a>,<a href='../S/79.html#L24' title='Defined at 24 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>NEWRATE</a>))
<a name='L209'> 209                 <a href='../S/79.html#L84' title='Defined at 84 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>new_rate</a>(<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>);
<a name='L210'> 210         <b>else</b>
<a name='L211'> 211                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Unknown timer event: %s", <a href='../Y/7069.html' title='Multiple used in 188 places.'>str</a>);
<a name='L212'> 212         <b>return</b> 0;
<a name='L213'> 213 <font color='red'>}</font>
<a name='L214'> 214 
<a name='L215'> 215 
<a name='L216'> 216 <i><font color='green'>/** Handle timer event</font></i>
<a name='L217'> 217 <i><font color='green'> * @param ctx pointer to opaque context</font></i>
<a name='L218'> 218 <i><font color='green'> * @param pkt_in pointer to packet in event</font></i>
<a name='L219'> 219 <i><font color='green'> */</font></i>
<a name='L220'> 220 <b>int</b> <a href='../R/3767.html' title='Multiple refered from 3 places.'>of_event_packet_in</a>(<b>struct</b> <a href='../Y/5077.html' title='Multiple used in 258 places.'>oflops_context</a> *<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>, <b>struct</b> <a href='../Y/5229.html' title='Multiple used in 18 places.'>ofp_packet_in</a> * <a href='../Y/5748.html' title='Multiple used in 43 places.'>pkt_in</a>)
<a name='L221'> 221 <font color='red'>{</font>
<a name='L222'> 222   <b>return</b> 0;
<a name='L223'> 223 <font color='red'>}</font>
<a name='L224'> 224 
<a name='L225'> 225 <i><font color='green'>/** Register pcap filter.</font></i>
<a name='L226'> 226 <i><font color='green'> * @param ctx pointer to opaque context</font></i>
<a name='L227'> 227 <i><font color='green'> * @param ofc enumeration of channel that filter is being asked for</font></i>
<a name='L228'> 228 <i><font color='green'> * @param filter filter string for pcap</font></i>
<a name='L229'> 229 <i><font color='green'> * @param buflen length of buffer</font></i>
<a name='L230'> 230 <i><font color='green'> */</font></i>
<a name='L231'> 231 <b>int</b> <a href='../R/3180.html' title='Multiple refered from 3 places.'>get_pcap_filter</a>(<b>struct</b> <a href='../Y/5077.html' title='Multiple used in 258 places.'>oflops_context</a> *<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>, <a href='../Y/5076.html' title='Multiple used in 49 places.'>oflops_channel_name</a> <a href='../Y/5060.html' title='Multiple used in 47 places.'>ofc</a>, <b>char</b> * <a href='../Y/3075.html' title='Multiple used in 66 places.'>filter</a>, <b>int</b> <a href='../Y/1713.html' title='Multiple used in 72 places.'>buflen</a>)
<a name='L232'> 232 <font color='red'>{</font>
<a name='L233'> 233   <b>if</b>(<a href='../Y/5060.html' title='Multiple used in 47 places.'>ofc</a> == <a href='../S/55.html#L13' title='Defined at 13 in cbench/oflops/test_module.h.'>OFLOPS_CONTROL</a>)     <i><font color='green'>// pcap dump the control channel</font></i>
<a name='L234'> 234     <b>return</b> <a href='../Y/6891.html' title='Multiple used in 224 places.'>snprintf</a>(<a href='../Y/3075.html' title='Multiple used in 66 places.'>filter</a>,<a href='../Y/1713.html' title='Multiple used in 72 places.'>buflen</a>,"tcp port 6633");
<a name='L235'> 235   <b>else</b> 
<a name='L236'> 236     <b>return</b> 0;
<a name='L237'> 237 <font color='red'>}</font>
<a name='L238'> 238 
<a name='L239'> 239 
<a name='L240'> 240 <i><font color='green'>/** Handle pcap event.</font></i>
<a name='L241'> 241 <i><font color='green'> * @param ctx pointer to opaque context</font></i>
<a name='L242'> 242 <i><font color='green'> * @param pe pcap event</font></i>
<a name='L243'> 243 <i><font color='green'> * @param ch enumeration of channel that pcap event is triggered</font></i>
<a name='L244'> 244 <i><font color='green'> */</font></i>
<a name='L245'> 245 <b>int</b> <a href='../R/3191.html' title='Multiple refered from 3 places.'>handle_pcap_event</a>(<b>struct</b> <a href='../Y/5077.html' title='Multiple used in 258 places.'>oflops_context</a> *<a href='../Y/2205.html' title='Multiple used in 1149 places.'>ctx</a>, <b>struct</b> <a href='../Y/5671.html' title='Multiple used in 22 places.'>pcap_event</a> * <a href='../Y/5698.html' title='Multiple used in 154 places.'>pe</a>, <a href='../Y/5076.html' title='Multiple used in 49 places.'>oflops_channel_name</a> <a href='../Y/1844.html' title='Multiple used in 305 places.'>ch</a>)
<a name='L246'> 246 <font color='red'>{</font>
<a name='L247'> 247         <a href='../Y/7625.html' title='Multiple used in 747 places.'>uint8_t</a> <a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a>;
<a name='L248'> 248         <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a> <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>;
<a name='L249'> 249         <b>int</b> <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>;
<a name='L250'> 250         <a href='../D/9166.html' title='Multiple defined in 2 places.'>probe</a> * <a href='../Y/5568.html' title='Multiple used in 1140 places.'>p</a>;
<a name='L251'> 251         <b>if</b> (<a href='../Y/1844.html' title='Multiple used in 305 places.'>ch</a> != <a href='../S/55.html#L13' title='Defined at 13 in cbench/oflops/test_module.h.'>OFLOPS_CONTROL</a>)
<a name='L252'> 252         <font color='red'>{</font>
<a name='L253'> 253                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "wtf! why channel %u?", <a href='../Y/1844.html' title='Multiple used in 305 places.'>ch</a>);
<a name='L254'> 254                 <b>return</b> 0;
<a name='L255'> 255         <font color='red'>}</font>
<a name='L256'> 256         <i><font color='green'>//See packet received</font></i>
<a name='L257'> 257         <b>if</b>(<a href='../Y/5698.html' title='Multiple used in 154 places.'>pe</a>-&gt;<a href='../Y/5688.html' title='Multiple used in 122 places.'>pcaphdr</a>.<a href='../Y/1794.html' title='Multiple used in 22 places.'>caplen</a> &lt;70)
<a name='L258'> 258                 <b>return</b> 0;       <i><font color='green'>// not for us</font></i>
<a name='L259'> 259         <a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> = <a href='../Y/5698.html' title='Multiple used in 154 places.'>pe</a>-&gt;<a href='../Y/2247.html' title='Multiple used in 1185 places.'>data</a>[67];
<a name='L260'> 260         <b>if</b>(<a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> != 16 &amp;&amp; <a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> != 17)
<a name='L261'> 261                 <b>return</b> 0;
<a name='L262'> 262         <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a> = <a href='../Y/5698.html' title='Multiple used in 154 places.'>pe</a>-&gt;<a href='../Y/5688.html' title='Multiple used in 122 places.'>pcaphdr</a>.<a href='../Y/7493.html' title='Multiple used in 120 places.'>ts</a>;
<a name='L263'> 263         <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>  = *((<a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a>*) &amp;(<a href='../Y/5698.html' title='Multiple used in 154 places.'>pe</a>-&gt;<a href='../Y/2247.html' title='Multiple used in 1185 places.'>data</a>)[70]);
<a name='L264'> 264         <a href='../Y/1502.html' title='Multiple used in 179 places.'>assert</a>(<a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>&gt;=0);
<a name='L265'> 265         <a href='../Y/1502.html' title='Multiple used in 179 places.'>assert</a>(<a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>&lt;<a href='../S/79.html#L36' title='Defined at 36 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>MAX_OUTSTANDING</a>);
<a name='L266'> 266         <a href='../Y/5568.html' title='Multiple used in 1140 places.'>p</a> = &amp;<a href='../Y/5928.html' title='Multiple used in 7 places.'>probes</a>[<a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>];
<a name='L267'> 267         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Found unmarked probe.");
<a name='L268'> 268         <b>if</b> (<a href='../S/79.html#L14' title='Defined at 14 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>PACKET_IN_DEBUG</a>)
<a name='L269'> 269                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Got OpenFlow packet of length %u type %u at %ld.%.6ld of probe_index %d\n", 
<a name='L270'> 270                                 <a href='../Y/5698.html' title='Multiple used in 154 places.'>pe</a>-&gt;<a href='../Y/5688.html' title='Multiple used in 122 places.'>pcaphdr</a>.<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a>, <a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a>,
<a name='L271'> 271                                 <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>, 
<a name='L272'> 272                                 <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>);
<a name='L273'> 273 
<a name='L274'> 274         <i><font color='green'>//Handle stat request and stat reply</font></i>
<a name='L275'> 275         <b>if</b> (<a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> == 16)
<a name='L276'> 276         <font color='red'>{</font>
<a name='L277'> 277                 <i><font color='green'>//Record sending</font></i>
<a name='L278'> 278                 <a href='../Y/5568.html' title='Multiple used in 1140 places.'>p</a>-&gt;<a href='../Y/6665.html' title='Multiple used in 6 places.'>sent</a> = <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>;
<a name='L279'> 279                 <a href='../Y/5682.html' title='Multiple used in 2 places.'>pcap_sentcounter</a>++;
<a name='L280'> 280                 <b>if</b> (<a href='../S/79.html#L14' title='Defined at 14 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>PACKET_IN_DEBUG</a>)
<a name='L281'> 281                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Send stat request at %ld.%.6ld of probe_index %d\n", 
<a name='L282'> 282                                         <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>, 
<a name='L283'> 283                                         <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>);
<a name='L284'> 284         <font color='red'>}</font>
<a name='L285'> 285         <b>else</b> <b>if</b> (<a href='../Y/7553.html' title='Multiple used in 958 places.'>type</a> ==17)
<a name='L286'> 286         <font color='red'>{</font>
<a name='L287'> 287                 
<a name='L288'> 288                 <b>if</b> (<a href='../S/79.html#L14' title='Defined at 14 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>PACKET_IN_DEBUG</a>)
<a name='L289'> 289                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Receive stat reply at %ld.%.6ld of probe_index %d\n", 
<a name='L290'> 290                                         <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>, 
<a name='L291'> 291                                         <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>);
<a name='L292'> 292 
<a name='L293'> 293                 <i><font color='green'>//Calculate time difference</font></i>
<a name='L294'> 294                 <b>struct</b> <a href='../Y/7388.html' title='Multiple used in 197 places.'>timeval</a> <a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>;
<a name='L295'> 295                 <a href='../Y/7382.html' title='Multiple used in 5 places.'>timersub</a>(&amp;<a href='../Y/6152.html' title='Multiple used in 7 places.'>ptime</a>, &amp;<a href='../Y/5568.html' title='Multiple used in 1140 places.'>p</a>-&gt;<a href='../Y/6665.html' title='Multiple used in 6 places.'>sent</a>, &amp;<a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>);
<a name='L296'> 296                 <b>if</b> (<a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a> != 0)
<a name='L297'> 297                 <font color='red'>{</font>
<a name='L298'> 298                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Delay of &gt; 1 sec!\n");
<a name='L299'> 299                         <b>return</b> 0;
<a name='L300'> 300                 <font color='red'>}</font>
<a name='L301'> 301                 <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/2319.html' title='Multiple used in 7 places.'>delayfile</a>, "%d %ld.%.6ld\n", <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>, <a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>);
<a name='L302'> 302                 <a href='../Y/7442.html' title='Multiple used in 3 places.'>totaldelay</a> += (<a href='../Y/7623.html' title='Multiple used in 568 places.'>uint64_t</a>) <a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>;
<a name='L303'> 303                 <a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a>++;
<a name='L304'> 304                 <a href='../Y/5568.html' title='Multiple used in 1140 places.'>p</a>-&gt;<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>=0;
<a name='L305'> 305 
<a name='L306'> 306                 <b>if</b> (<a href='../S/79.html#L14' title='Defined at 14 in cbench/oflops/example_modules/openflow_port_status/portstat.c.'>PACKET_IN_DEBUG</a>)
<a name='L307'> 307                 <font color='red'>{</font>
<a name='L308'> 308                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "Got stat of probe_index %d with delay %ld.%.6ld\n", 
<a name='L309'> 309                                         <a href='../Y/5917.html' title='Multiple used in 10 places.'>probe_index</a>,
<a name='L310'> 310                                         <a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>.<a href='../Y/7510.html' title='Multiple used in 122 places.'>tv_sec</a>, <a href='../Y/7370.html' title='Multiple used in 6 places.'>timediff</a>.<a href='../Y/7511.html' title='Multiple used in 105 places.'>tv_usec</a>);
<a name='L311'> 311                         <a href='../Y/3207.html' title='Multiple used in 289 places.'>fprintf</a>(<a href='../Y/7049.html' title='Multiple used in 246 places.'>stderr</a>, "\twith %lld packets sent and %lld received.\n", 
<a name='L312'> 312                                         (<b>long</b> <b>long</b> <b>int</b>)<a href='../Y/6666.html' title='Multiple used in 8 places.'>sentcounter</a>, (<b>long</b> <b>long</b> <b>int</b>)<a href='../Y/6302.html' title='Multiple used in 7 places.'>receivecounter</a>);
<a name='L313'> 313                 <font color='red'>}</font>
<a name='L314'> 314         <font color='red'>}</font>
<a name='L315'> 315         <b>return</b> 0;
<a name='L316'> 316 <font color='red'>}</font>
<a name='L317'> 317 
<a name='L318'> 318 
<a name='L319'> 319 
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L79'>[^]</a><a href='#L245'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
