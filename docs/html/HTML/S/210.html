<html>
<head>
<title>cbench/openflow/hw-lib/skeleton/port.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/1100.html'>cbench</a>/<a href='../files/1124.html'>openflow</a>/<a href='../files/1135.html'>hw-lib</a>/<a href='../files/1137.html'>skeleton</a>/port.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L58'>[^]</a><a href='#L480'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L58' title='Defined at 58.'>qid_find</a>
<li><a href='#L77' title='Defined at 77.'>of_hw_qid_find</a>
<li><a href='#L93' title='Defined at 93.'>qid_find_add</a>
<li><a href='#L120' title='Defined at 120.'>port_speed_change_reconfig</a>
<li><a href='#L145' title='Defined at 145.'>of_hw_linkscan_handler</a>
<li><a href='#L181' title='Defined at 181.'>of_hw_ports_init</a>
<li><a href='#L206' title='Defined at 206.'>of_hw_port_stats_get</a>
<li><a href='#L258' title='Defined at 258.'>of_hw_port_add</a>
<li><a href='#L299' title='Defined at 299.'>of_hw_port_remove</a>
<li><a href='#L342' title='Defined at 342.'>of_hw_port_link_get</a>
<li><a href='#L363' title='Defined at 363.'>of_hw_port_enable_set</a>
<li><a href='#L379' title='Defined at 379.'>of_hw_port_enable_get</a>
<li><a href='#L404' title='Defined at 404.'>of_hw_port_change_register</a>
<li><a href='#L427' title='Defined at 427.'>of_hw_cos_setup</a>
<li><a href='#L445' title='Defined at 445.'>of_hw_port_queue_config</a>
<li><a href='#L480' title='Defined at 480.'>of_hw_port_queue_remove</a>
</ol>
<hr>
<pre>
<a name='L1'>   1 <i><font color='green'>/*</font></i>
<a name='L2'>   2 <i><font color='green'> * Port related HW datapath functions</font></i>
<a name='L3'>   3 <i><font color='green'> */</font></i>
<a name='L4'>   4 
<a name='L5'>   5 <font color='darkred'>#include</font> &lt;<a href='181.html'>openflow/openflow.h</a>&gt;
<a name='L6'>   6 <font color='darkred'>#include</font> &lt;<a href='183.html'>of_hw_api.h</a>&gt;
<a name='L7'>   7 
<a name='L8'>   8 <font color='darkred'>#include</font> "<a href='889.html'>xtoxll.h</a>"
<a name='L9'>   9 <font color='darkred'>#include</font> "<a href='222.html'>hw_drv.h</a>"
<a name='L10'>  10 <font color='darkred'>#include</font> "<a href='220.html'>of_hw_platform.h</a>"
<a name='L11'>  11 <font color='darkred'>#include</font> "<a href='213.html'>port.h</a>"
<a name='L12'>  12 <font color='darkred'>#include</font> "<a href='../I/149.html'>debug.h</a>"
<a name='L13'>  13 
<a name='L14'>  14 <i><font color='green'>/* Single set of HW port objects managed here; indexed by OF port num */</font></i>
<a name='L15'>  15 <a href='../S/213.html#L17' title='Defined at 17 in cbench/openflow/hw-lib/skeleton/port.h.'>of_hw_port_t</a> <a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>];
<a name='L16'>  16 
<a name='L17'>  17 <i><font color='green'>/* Check if hw DP and port are valid and if port belongs to the DP */</font></i>
<a name='L18'>  18 <font color='darkred'>#define</font> <a href='../R/174.html' title='Multiple refered from 5 places.'>CHECK_PORT</a>(<a href='../Y/1198.html' title='Multiple used in 5 places.'>_drv</a>, <a href='../Y/1224.html' title='Multiple used in 3 places.'>_p</a>) <b>do</b> <font color='red'>{</font>                                   \
<a name='L19'>  19     <b>if</b> ((<a href='../Y/1198.html' title='Multiple used in 5 places.'>_drv</a>) == <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <b>return</b> -1;                                  \
<a name='L20'>  20     <b>if</b> (((<a href='../Y/1224.html' title='Multiple used in 3 places.'>_p</a>) &lt; 1) || ((<a href='../Y/1224.html' title='Multiple used in 3 places.'>_p</a>) &gt; <a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>)) <font color='red'>{</font>                   \
<a name='L21'>  21         <a href='../D/5124.html' title='Multiple defined in 4 places.'>REPORT_ERROR</a>("bad port number");                            \
<a name='L22'>  22         <b>return</b> -1;                                                  \
<a name='L23'>  23     <font color='red'>}</font>                                                               \
<a name='L24'>  24     <b>if</b> (!(<a href='../S/222.html#L30' title='Defined at 30 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>OF_PORT_IN_DP</a>(((<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *)(<a href='../Y/1198.html' title='Multiple used in 5 places.'>_drv</a>)), (<a href='../Y/1224.html' title='Multiple used in 3 places.'>_p</a>)))) <font color='red'>{</font>   \
<a name='L25'>  25         <a href='../D/5124.html' title='Multiple defined in 4 places.'>REPORT_ERROR</a>("DP does not own port");                       \
<a name='L26'>  26         <b>return</b> -1;                                                  \
<a name='L27'>  27     <font color='red'>}</font>                                                               \
<a name='L28'>  28 <font color='red'>}</font> <b>while</b> (0)
<a name='L29'>  29 
<a name='L30'>  30 
<a name='L31'>  31 <i><font color='green'>/*</font></i>
<a name='L32'>  32 <i><font color='green'> * Queue configuration section</font></i>
<a name='L33'>  33 <i><font color='green'> *</font></i>
<a name='L34'>  34 <i><font color='green'> * Port queue:  Per port structure for queue related information</font></i>
<a name='L35'>  35 <i><font color='green'> * Queue map: Indicated queue is mapped and what OF qid its mapped to as</font></i>
<a name='L36'>  36 <i><font color='green'> *     well as queue properties (min-bw).  Indexed by OF port number;</font></i>
<a name='L37'>  37 <i><font color='green'> *     per port instance of array</font></i>
<a name='L38'>  38 <i><font color='green'> *</font></i>
<a name='L39'>  39 <i><font color='green'> */</font></i>
<a name='L40'>  40 
<a name='L41'>  41 <b>typedef</b> <b>struct</b> <a href='../R/4237.html' title='Multiple refered from 4 places.'>queue_map_s</a> <font color='red'>{</font>
<a name='L42'>  42         <b>int</b> <a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>;
<a name='L43'>  43         <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>; <i><font color='green'>/* OF queue name */</font></i>
<a name='L44'>  44         <b>int</b> <a href='../Y/4452.html' title='Multiple used in 5 places.'>min_bw</a>;   <i><font color='green'>/* OF value, tenths of a percent */</font></i>
<a name='L45'>  45 <font color='red'>}</font> <a href='../S/210.html#L49' title='Refered from 49 in cbench/openflow/hw-lib/skeleton/port.c.'>queue_map_t</a>;
<a name='L46'>  46 
<a name='L47'>  47 <b>typedef</b> <b>struct</b> port_queue_s <font color='red'>{</font>
<a name='L48'>  48     <b>int</b> <a href='../Y/6916.html' title='Multiple used in 35 places.'>speed</a>; <i><font color='green'>/* In Mbps */</font></i>
<a name='L49'>  49     <a href='../S/210.html#L45' title='Defined at 45 in cbench/openflow/hw-lib/skeleton/port.c.'>queue_map_t</a> <a href='../Y/6213.html' title='Multiple used in 6 places.'>queue_map</a>[<a href='../S/213.html#L8' title='Defined at 8 in cbench/openflow/hw-lib/skeleton/port.h.'>NUM_COS_QUEUES</a>];
<a name='L50'>  50 <font color='red'>}</font> <a href='../S/210.html#L52' title='Refered from 52 in cbench/openflow/hw-lib/skeleton/port.c.'>port_queue_t</a>;
<a name='L51'>  51 
<a name='L52'>  52 <b>static</b> <a href='../S/210.html#L50' title='Defined at 50 in cbench/openflow/hw-lib/skeleton/port.c.'>port_queue_t</a> <a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>];
<a name='L53'>  53 
<a name='L54'>  54 <i><font color='green'>/* Return the cos for the queue matching qid if found; else -1.</font></i>
<a name='L55'>  55 <i><font color='green'> * Assumes lock held</font></i>
<a name='L56'>  56 <i><font color='green'> */</font></i>
<a name='L57'>  57 <b>static</b> <b>int</b>
<a name='L58'>  58 <a href='../R/4229.html' title='Multiple refered from 3 places.'>qid_find</a>(<b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)
<a name='L59'>  59 <font color='red'>{</font>
<a name='L60'>  60     <b>struct</b> <a href='../S/210.html#L41' title='Defined at 41 in cbench/openflow/hw-lib/skeleton/port.c.'>queue_map_s</a> *<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>;
<a name='L61'>  61     <b>int</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L62'>  62 
<a name='L63'>  63     <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a> = <a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6213.html' title='Multiple used in 6 places.'>queue_map</a>;
<a name='L64'>  64     <b>for</b> (<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = 0; <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> &lt; <a href='../S/213.html#L8' title='Defined at 8 in cbench/openflow/hw-lib/skeleton/port.h.'>NUM_COS_QUEUES</a>; <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>++) <font color='red'>{</font>
<a name='L65'>  65         <b>if</b> (<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a> &amp;&amp; (<a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a> == <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)) <font color='red'>{</font>
<a name='L66'>  66             <b>return</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L67'>  67         <font color='red'>}</font>
<a name='L68'>  68     <font color='red'>}</font>
<a name='L69'>  69 
<a name='L70'>  70     <b>return</b> -1;
<a name='L71'>  71 <font color='red'>}</font>
<a name='L72'>  72 
<a name='L73'>  73 <i><font color='green'>/* Return the cos for the queue matching qid if found; else -1.</font></i>
<a name='L74'>  74 <i><font color='green'> * Assumes lock held</font></i>
<a name='L75'>  75 <i><font color='green'> */</font></i>
<a name='L76'>  76 <b>int</b>
<a name='L77'>  77 <a href='../R/3798.html' title='Multiple refered from 2 places.'>of_hw_qid_find</a>(<b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)
<a name='L78'>  78 <font color='red'>{</font>
<a name='L79'>  79     <b>int</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L80'>  80 
<a name='L81'>  81     <i><font color='green'>/* LOCK */</font></i>
<a name='L82'>  82     <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = <a href='../S/210.html#L58' title='Defined at 58 in cbench/openflow/hw-lib/skeleton/port.c.'>qid_find</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>);
<a name='L83'>  83     <i><font color='green'>/* UNLOCK */</font></i>
<a name='L84'>  84 
<a name='L85'>  85     <b>return</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L86'>  86 <font color='red'>}</font>
<a name='L87'>  87 
<a name='L88'>  88 <i><font color='green'>/*</font></i>
<a name='L89'>  89 <i><font color='green'> * Map an OF qid to a COS queue index; if not present, add it if possible</font></i>
<a name='L90'>  90 <i><font color='green'> * Assumes lock held</font></i>
<a name='L91'>  91 <i><font color='green'> */</font></i>
<a name='L92'>  92 <b>static</b> <b>int</b>
<a name='L93'>  93 <a href='../S/210.html#L460' title='Refered from 460 in cbench/openflow/hw-lib/skeleton/port.c.'>qid_find_add</a>(<b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)
<a name='L94'>  94 <font color='red'>{</font>
<a name='L95'>  95     <b>struct</b> <a href='../S/210.html#L41' title='Defined at 41 in cbench/openflow/hw-lib/skeleton/port.c.'>queue_map_s</a> *<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>;
<a name='L96'>  96     <b>int</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L97'>  97 
<a name='L98'>  98     <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = <a href='../S/210.html#L58' title='Defined at 58 in cbench/openflow/hw-lib/skeleton/port.c.'>qid_find</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>);
<a name='L99'>  99     <b>if</b> (<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> &gt;= 0) <font color='red'>{</font>
<a name='L100'> 100         <b>return</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L101'> 101     <font color='red'>}</font>
<a name='L102'> 102 
<a name='L103'> 103     <i><font color='green'>/* Not found; add queue */</font></i>
<a name='L104'> 104     <b>for</b> (<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = 0; <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> &lt; <a href='../S/213.html#L8' title='Defined at 8 in cbench/openflow/hw-lib/skeleton/port.h.'>NUM_COS_QUEUES</a>; <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>++) <font color='red'>{</font>
<a name='L105'> 105         <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a> = <a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6213.html' title='Multiple used in 6 places.'>queue_map</a>;
<a name='L106'> 106         <b>if</b> (!<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>) <font color='red'>{</font>
<a name='L107'> 107             <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a> = <a href='../Y/7480.html' title='Multiple used in 168 places.'>true</a>;
<a name='L108'> 108             <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a> = <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>;
<a name='L109'> 109             <b>return</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L110'> 110         <font color='red'>}</font>
<a name='L111'> 111     <font color='red'>}</font>
<a name='L112'> 112 
<a name='L113'> 113     <b>return</b> -1;
<a name='L114'> 114 <font color='red'>}</font>
<a name='L115'> 115 
<a name='L116'> 116 <i><font color='green'>/*</font></i>
<a name='L117'> 117 <i><font color='green'> * Port speed has changed; requires queue b/w to change</font></i>
<a name='L118'> 118 <i><font color='green'> */</font></i>
<a name='L119'> 119 <b>static</b> <b>void</b>
<a name='L120'> 120 <a href='../S/210.html#L162' title='Refered from 162 in cbench/openflow/hw-lib/skeleton/port.c.'>port_speed_change_reconfig</a>(<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>)
<a name='L121'> 121 <font color='red'>{</font>
<a name='L122'> 122     <b>int</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L123'> 123     <b>struct</b> <a href='../S/210.html#L41' title='Defined at 41 in cbench/openflow/hw-lib/skeleton/port.c.'>queue_map_s</a> *<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>;
<a name='L124'> 124     <b>int</b> <a href='../Y/6512.html' title='Multiple used in 34 places.'>rv</a>;
<a name='L125'> 125 
<a name='L126'> 126     <i><font color='green'>/* LOCK */</font></i>
<a name='L127'> 127     <b>for</b> (<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = 0; <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> &lt; <a href='../S/213.html#L8' title='Defined at 8 in cbench/openflow/hw-lib/skeleton/port.h.'>NUM_COS_QUEUES</a>; <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>++) <font color='red'>{</font>
<a name='L128'> 128         <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a> = <a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6213.html' title='Multiple used in 6 places.'>queue_map</a>;
<a name='L129'> 129         <b>if</b> (<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a>) <font color='red'>{</font>
<a name='L130'> 130             <i><font color='green'>/* FIXME:  Calc and program values for HW for min-bw */</font></i>
<a name='L131'> 131             <b>if</b> (<a href='../Y/6512.html' title='Multiple used in 34 places.'>rv</a> &lt; 0) <font color='red'>{</font>
<a name='L132'> 132                 <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("ERROR: Set min BW for queue on port %d "
<a name='L133'> 133                           "link change\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L134'> 134             <font color='red'>}</font>
<a name='L135'> 135         <font color='red'>}</font>
<a name='L136'> 136     <font color='red'>}</font>
<a name='L137'> 137     <i><font color='green'>/* UNLOCK */</font></i>
<a name='L138'> 138 <font color='red'>}</font>
<a name='L139'> 139 
<a name='L140'> 140 
<a name='L141'> 141 <i><font color='green'>/* Internal handler for port link status changes */</font></i>
<a name='L142'> 142 
<a name='L143'> 143 <i><font color='green'>/* FIXME */</font></i>
<a name='L144'> 144 <b>static</b> <b>void</b>
<a name='L145'> 145 of_hw_linkscan_handler(...)
<a name='L146'> 146 <font color='red'>{</font>
<a name='L147'> 147     <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>;
<a name='L148'> 148     <a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>;
<a name='L149'> 149 
<a name='L150'> 150     <i><font color='green'>/* Assumes speed, linkstatus from HW */</font></i>
<a name='L151'> 151     <i><font color='green'>/* Map port to internal port object */</font></i>
<a name='L152'> 152     <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> = HW_MAP_TO_PORT();
<a name='L153'> 153     <b>if</b> ((<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> &lt; 0) || (<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> &gt; <a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>)) <font color='red'>{</font>
<a name='L154'> 154         <b>return</b>;
<a name='L155'> 155     <font color='red'>}</font>
<a name='L156'> 156 
<a name='L157'> 157     <i><font color='green'>/* LOCK */</font></i>
<a name='L158'> 158     <a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a> = (<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *)(<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a>);
<a name='L159'> 159     <b>if</b> (<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a> != <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <font color='red'>{</font>
<a name='L160'> 160         <b>if</b> (<a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6916.html' title='Multiple used in 35 places.'>speed</a> != <a href='../Y/6916.html' title='Multiple used in 35 places.'>speed</a>) <font color='red'>{</font>
<a name='L161'> 161             <a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6916.html' title='Multiple used in 35 places.'>speed</a> = <a href='../Y/6916.html' title='Multiple used in 35 places.'>speed</a>;
<a name='L162'> 162             <a href='../S/210.html#L120' title='Defined at 120 in cbench/openflow/hw-lib/skeleton/port.c.'>port_speed_change_reconfig</a>(<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L163'> 163         <font color='red'>}</font>
<a name='L164'> 164     <font color='red'>}</font>
<a name='L165'> 165     <i><font color='green'>/* Record in local struct */</font></i>
<a name='L166'> 166     <a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/4140.html' title='Multiple used in 107 places.'>link</a> = <a href='../Y/4144.html' title='Multiple used in 2 places.'>linkstatus</a> != 0;
<a name='L167'> 167     <b>if</b> ((<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a> != <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) &amp;&amp; (<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>-&gt;<a href='../Y/5801.html' title='Multiple used in 4 places.'>port_change</a> != <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>)) <font color='red'>{</font>
<a name='L168'> 168         <a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>-&gt;<a href='../Y/5801.html' title='Multiple used in 4 places.'>port_change</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/4144.html' title='Multiple used in 2 places.'>linkstatus</a> != 0,
<a name='L169'> 169                             <a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>-&gt;<a href='../Y/5802.html' title='Multiple used in 3 places.'>port_change_cookie</a>);
<a name='L170'> 170     <font color='red'>}</font>
<a name='L171'> 171     <i><font color='green'>/* UNLOCK */</font></i>
<a name='L172'> 172 <font color='red'>}</font>
<a name='L173'> 173 
<a name='L174'> 174 <b>static</b> <b>int</b> <a href='../Y/4143.html' title='Multiple used in 3 places.'>linkscan_registered</a>;
<a name='L175'> 175 
<a name='L176'> 176 <i><font color='green'>/*</font></i>
<a name='L177'> 177 <i><font color='green'> * of_hw_ports_init</font></i>
<a name='L178'> 178 <i><font color='green'> *     Set up hardware port map</font></i>
<a name='L179'> 179 <i><font color='green'> */</font></i>
<a name='L180'> 180 <b>void</b>
<a name='L181'> 181 <a href='../R/3797.html' title='Multiple refered from 2 places.'>of_hw_ports_init</a>(<b>void</b>)
<a name='L182'> 182 <font color='red'>{</font>
<a name='L183'> 183     <b>int</b> <a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>;
<a name='L184'> 184 
<a name='L185'> 185     <b>for</b> (<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a> = 0; <a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a> &lt; <a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>; <a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>++) <font color='red'>{</font>
<a name='L186'> 186         <a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>].<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> = <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>;
<a name='L187'> 187         <a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>].<a href='../Y/5791.html' title='Multiple used in 749 places.'>port</a> = <a href='../Y/532.html' title='Multiple used in 2 places.'>MAP_OF_PORT_TO_HW_PORT</a>(<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>);
<a name='L188'> 188     <font color='red'>}</font>
<a name='L189'> 189 
<a name='L190'> 190     <i><font color='green'>/* FIXME:  REGISTER FOR LINK CHANGE CALLBACK */</font></i>
<a name='L191'> 191     <i><font color='green'>/* Always register linkscan handler */</font></i>
<a name='L192'> 192     <a href='../Y/4143.html' title='Multiple used in 3 places.'>linkscan_registered</a> = 1;
<a name='L193'> 193 
<a name='L194'> 194     <i><font color='green'>/* Get current link status for each port; ignore errors for bad ports */</font></i>
<a name='L195'> 195     <b>for</b> (<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a> = 0; <a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a> &lt; <a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>; <a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>++) <font color='red'>{</font>
<a name='L196'> 196         <i><font color='green'>/* FIXME */</font></i>
<a name='L197'> 197         HW_LINK_STATUS_GET(<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>].<a href='../Y/5791.html' title='Multiple used in 749 places.'>port</a>, &amp;<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/3700.html' title='Multiple used in 2939 places.'>i</a>].<a href='../Y/4140.html' title='Multiple used in 107 places.'>link</a>);
<a name='L198'> 198     <font color='red'>}</font>
<a name='L199'> 199 <font color='red'>}</font>
<a name='L200'> 200 
<a name='L201'> 201 
<a name='L202'> 202 <font color='darkred'>#define</font> <a href='../R/681.html' title='Multiple refered from 12 places.'>HTON64</a> <a href='../D/8058.html' title='Multiple defined in 14 places.'>htonll</a>
<a name='L203'> 203 
<a name='L204'> 204 <i><font color='green'>/* Get port stats into a standard openflow port stats structure */</font></i>
<a name='L205'> 205 <b>int</b>
<a name='L206'> 206 <a href='../R/3794.html' title='Multiple refered from 2 places.'>of_hw_port_stats_get</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>,
<a name='L207'> 207                       <b>struct</b> <a href='../Y/5284.html' title='Multiple used in 8 places.'>ofp_port_stats</a> *<a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>)
<a name='L208'> 208 <font color='red'>{</font>
<a name='L209'> 209     uint64 <a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>, <a href='../Y/7704.html' title='Multiple used in 5 places.'>v2</a>;
<a name='L210'> 210 
<a name='L211'> 211     <a href='../S/210.html#L18' title='Defined at 18 in cbench/openflow/hw-lib/skeleton/port.c.'>CHECK_PORT</a>(<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L212'> 212 
<a name='L213'> 213 
<a name='L214'> 214 <font color='darkred'>#if</font> 0    <i><font color='green'>/* FIXME;  Get stats from HW */</font></i>
<a name='L215'> 215     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfInNUcastPkts, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L216'> 216     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfInUcastPkts, &amp;<a href='../Y/7704.html' title='Multiple used in 5 places.'>v2</a>);
<a name='L217'> 217     <a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a> += <a href='../Y/7704.html' title='Multiple used in 5 places.'>v2</a>;
<a name='L218'> 218     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6526.html' title='Multiple used in 32 places.'>rx_packets</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L219'> 219     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>,  snmpIfOutNUcastPkts, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L220'> 220     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfOutUcastPkts, &amp;<a href='../Y/7704.html' title='Multiple used in 5 places.'>v2</a>);
<a name='L221'> 221     <a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a> += <a href='../Y/7704.html' title='Multiple used in 5 places.'>v2</a>;
<a name='L222'> 222     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/7534.html' title='Multiple used in 38 places.'>tx_packets</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L223'> 223     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfInOctets, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L224'> 224     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6515.html' title='Multiple used in 32 places.'>rx_bytes</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L225'> 225     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfOutOctets, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L226'> 226     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/7530.html' title='Multiple used in 38 places.'>tx_bytes</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L227'> 227     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfInDiscards, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L228'> 228     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6519.html' title='Multiple used in 9 places.'>rx_dropped</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L229'> 229     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfOutDiscards, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L230'> 230     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/7531.html' title='Multiple used in 15 places.'>tx_dropped</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L231'> 231     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfInErrors, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L232'> 232     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6520.html' title='Multiple used in 9 places.'>rx_errors</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L233'> 233     <a href='../Y/438.html' title='Multiple used in 10 places.'>HW_STAT</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, snmpIfOutErrors, &amp;<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L234'> 234     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/7532.html' title='Multiple used in 15 places.'>tx_errors</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L235'> 235 <font color='darkred'>#endif</font>
<a name='L236'> 236 
<a name='L237'> 237     <a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a> = <a href='../Y/986.html' title='Multiple used in 6 places.'>UINT64_C</a>(0xffffffffffffffff);
<a name='L238'> 238     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6521.html' title='Multiple used in 9 places.'>rx_frame_err</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L239'> 239     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6524.html' title='Multiple used in 9 places.'>rx_over_err</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L240'> 240     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/6517.html' title='Multiple used in 9 places.'>rx_crc_err</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L241'> 241     <a href='../Y/7023.html' title='Multiple used in 238 places.'>stats</a>-&gt;<a href='../Y/2002.html' title='Multiple used in 9 places.'>collisions</a> = <a href='../S/210.html#L202' title='Defined at 202 in cbench/openflow/hw-lib/skeleton/port.c.'>HTON64</a>(<a href='../Y/7703.html' title='Multiple used in 24 places.'>v1</a>);
<a name='L242'> 242 
<a name='L243'> 243     <b>return</b> 0;
<a name='L244'> 244 <font color='red'>}</font>
<a name='L245'> 245 
<a name='L246'> 246 <i><font color='green'>/*</font></i>
<a name='L247'> 247 <i><font color='green'> * port_add/remove(table, port)</font></i>
<a name='L248'> 248 <i><font color='green'> *</font></i>
<a name='L249'> 249 <i><font color='green'> * The indicated port has been added to/removed from the datapath</font></i>
<a name='L250'> 250 <i><font color='green'> * Add also maps the of_port number to the hw_port indicated</font></i>
<a name='L251'> 251 <i><font color='green'> *</font></i>
<a name='L252'> 252 <i><font color='green'> * SPEC CHANGE:  If of_port passed is less than 0, use the passed</font></i>
<a name='L253'> 253 <i><font color='green'> * port name to determine the port number and attach to that value;</font></i>
<a name='L254'> 254 <i><font color='green'> *</font></i>
<a name='L255'> 255 <i><font color='green'> * Returns the of_port number or -1 on error</font></i>
<a name='L256'> 256 <i><font color='green'> */</font></i>
<a name='L257'> 257 <b>int</b>
<a name='L258'> 258 <a href='../R/3786.html' title='Multiple refered from 2 places.'>of_hw_port_add</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <b>const</b> <b>char</b> *<a href='../Y/3691.html' title='Multiple used in 8 places.'>hw_name</a>)
<a name='L259'> 259 <font color='red'>{</font>
<a name='L260'> 260     <b>int</b> <a href='../Y/3689.html' title='Multiple used in 4 places.'>hw_idx</a>;
<a name='L261'> 261     <a href='../S/213.html#L17' title='Defined at 17 in cbench/openflow/hw-lib/skeleton/port.h.'>of_hw_port_t</a> *<a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>;
<a name='L262'> 262     <a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>;
<a name='L263'> 263 
<a name='L264'> 264     <b>if</b> (<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a> == <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <font color='red'>{</font>
<a name='L265'> 265         <b>return</b> -1;
<a name='L266'> 266     <font color='red'>}</font>
<a name='L267'> 267 
<a name='L268'> 268     <a href='../Y/3689.html' title='Multiple used in 4 places.'>hw_idx</a> = <a href='../S/214.html#L38' title='Defined at 38 in cbench/openflow/hw-lib/skeleton/sample_plat.h.'>hw_port_name_to_index</a>(<a href='../Y/3691.html' title='Multiple used in 8 places.'>hw_name</a>);
<a name='L269'> 269     <b>if</b> (<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> &lt; 0) <font color='red'>{</font>
<a name='L270'> 270         <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> = <a href='../Y/3689.html' title='Multiple used in 4 places.'>hw_idx</a> + 1;
<a name='L271'> 271     <font color='red'>}</font> <b>else</b> <b>if</b> (<a href='../Y/3689.html' title='Multiple used in 4 places.'>hw_idx</a> + 1 != <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>) <font color='red'>{</font>
<a name='L272'> 272         <a href='../D/1153.html' title='Multiple defined in 4 places.'>DBG_WARN</a>("Add Port:  OF port %d does not match name %s\n",
<a name='L273'> 273                    <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/3691.html' title='Multiple used in 8 places.'>hw_name</a>);
<a name='L274'> 274     <font color='red'>}</font>
<a name='L275'> 275 
<a name='L276'> 276     <b>if</b> (<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> &gt;= <a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>) <font color='red'>{</font>
<a name='L277'> 277         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("Add Port:  Bad port number %d\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L278'> 278         <b>return</b> -1;
<a name='L279'> 279     <font color='red'>}</font>
<a name='L280'> 280 
<a name='L281'> 281     <a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a> = (<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *)<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>;
<a name='L282'> 282     <a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a> = &amp;<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>];
<a name='L283'> 283 
<a name='L284'> 284     <a href='../S/222.html#L92' title='Defined at 92 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>HW_DRV_LOCK</a>;
<a name='L285'> 285     <b>if</b> (<a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>-&gt;<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> == <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <font color='red'>{</font>
<a name='L286'> 286         <a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>-&gt;<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> = <a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>;
<a name='L287'> 287         <i><font color='green'>/* FIXME:  port bitmaps in HW structure */</font></i>
<a name='L288'> 288     <font color='red'>}</font> <b>else</b> <b>if</b> (<a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>-&gt;<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> != <a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>) <font color='red'>{</font>
<a name='L289'> 289         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("Add Port:  OF port %d owned by other DP\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L290'> 290     <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L291'> 291         <a href='../D/1153.html' title='Multiple defined in 4 places.'>DBG_WARN</a>("Add Port:  OF port %d already added\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L292'> 292     <font color='red'>}</font>
<a name='L293'> 293     <a href='../S/222.html#L93' title='Defined at 93 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>HW_DRV_UNLOCK</a>;
<a name='L294'> 294 
<a name='L295'> 295     <b>return</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>;
<a name='L296'> 296 <font color='red'>}</font>
<a name='L297'> 297 
<a name='L298'> 298 <b>int</b>
<a name='L299'> 299 <a href='../R/3793.html' title='Multiple refered from 2 places.'>of_hw_port_remove</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <a href='../S/183.html#L68' title='Defined at 68 in cbench/openflow/include/openflow/of_hw_api.h.'>of_port_t</a> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>)
<a name='L300'> 300 <font color='red'>{</font>
<a name='L301'> 301     <a href='../S/213.html#L17' title='Defined at 17 in cbench/openflow/hw-lib/skeleton/port.h.'>of_hw_port_t</a> *<a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>;
<a name='L302'> 302     <a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>;
<a name='L303'> 303     <b>int</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a> = 0;
<a name='L304'> 304 
<a name='L305'> 305     <b>if</b> (<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a> == <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <font color='red'>{</font>
<a name='L306'> 306         <b>return</b> -1;
<a name='L307'> 307     <font color='red'>}</font>
<a name='L308'> 308 
<a name='L309'> 309     <b>if</b> ((<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> &lt; 1) || (<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a> &gt;= <a href='../S/220.html#L16' title='Defined at 16 in cbench/openflow/hw-lib/skeleton/of_hw_platform.h.'>OF_HW_MAX_PORT</a>)) <font color='red'>{</font>
<a name='L310'> 310         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("Remove Port:  Bad port number %d\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L311'> 311         <b>return</b> -1;
<a name='L312'> 312     <font color='red'>}</font>
<a name='L313'> 313 
<a name='L314'> 314     <a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a> = (<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *)<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>;
<a name='L315'> 315     <a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a> = &amp;<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>];
<a name='L316'> 316 
<a name='L317'> 317     <a href='../S/222.html#L92' title='Defined at 92 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>HW_DRV_LOCK</a>;
<a name='L318'> 318     <b>if</b> (<a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>-&gt;<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> == <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <font color='red'>{</font>
<a name='L319'> 319         <a href='../D/1153.html' title='Multiple defined in 4 places.'>DBG_WARN</a>("Remove Port:  OF port %d already free\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L320'> 320     <font color='red'>}</font> <b>else</b> <b>if</b> (<a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>-&gt;<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> != <a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>) <font color='red'>{</font>
<a name='L321'> 321         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("Remove Port:  OF port %d owned by other DP\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L322'> 322         <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a> = -1;
<a name='L323'> 323     <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L324'> 324         <a href='../Y/5807.html' title='Multiple used in 10 places.'>port_ctl</a>-&gt;<a href='../Y/5563.html' title='Multiple used in 21 places.'>owner</a> = <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>;
<a name='L325'> 325     <font color='red'>}</font>
<a name='L326'> 326     <i><font color='green'>/* FIXME UPDATE HW port bitmaps in hw_int */</font></i>
<a name='L327'> 327     <a href='../S/222.html#L93' title='Defined at 93 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>HW_DRV_UNLOCK</a>;
<a name='L328'> 328 
<a name='L329'> 329     <b>return</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>;
<a name='L330'> 330 <font color='red'>}</font>
<a name='L331'> 331 
<a name='L332'> 332 
<a name='L333'> 333 <i><font color='green'>/*</font></i>
<a name='L334'> 334 <i><font color='green'> * port_link_get(table, port)</font></i>
<a name='L335'> 335 <i><font color='green'> * port_enable_set(table, port, enable)</font></i>
<a name='L336'> 336 <i><font color='green'> * port_enable_get(table, port)</font></i>
<a name='L337'> 337 <i><font color='green'> *</font></i>
<a name='L338'> 338 <i><font color='green'> * Get/set the indicated properties of a port.  Only real ports</font></i>
<a name='L339'> 339 <i><font color='green'> * set with port_add are supported.</font></i>
<a name='L340'> 340 <i><font color='green'> */</font></i>
<a name='L341'> 341 <b>int</b>
<a name='L342'> 342 <a href='../R/3790.html' title='Multiple refered from 2 places.'>of_hw_port_link_get</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>)
<a name='L343'> 343 <font color='red'>{</font>
<a name='L344'> 344     <b>int</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>;
<a name='L345'> 345     <b>int</b> <a href='../Y/4140.html' title='Multiple used in 107 places.'>link</a>;
<a name='L346'> 346 
<a name='L347'> 347     <a href='../S/210.html#L18' title='Defined at 18 in cbench/openflow/hw-lib/skeleton/port.c.'>CHECK_PORT</a>(<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L348'> 348 
<a name='L349'> 349     <b>if</b> (<a href='../Y/4143.html' title='Multiple used in 3 places.'>linkscan_registered</a>) <font color='red'>{</font>
<a name='L350'> 350         <b>return</b> <a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/4140.html' title='Multiple used in 107 places.'>link</a>;
<a name='L351'> 351     <font color='red'>}</font>
<a name='L352'> 352 
<a name='L353'> 353     <b>if</b> ((<a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a> = HW_LINK_GET(<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/5791.html' title='Multiple used in 749 places.'>port</a>, &amp;<a href='../Y/4140.html' title='Multiple used in 107 places.'>link</a>)) &lt; 0) <font color='red'>{</font>
<a name='L354'> 354         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("link_get: error %d port %d\n", <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L355'> 355         <i><font color='green'>/* Return link down on error */</font></i>
<a name='L356'> 356         <b>return</b> 0;
<a name='L357'> 357     <font color='red'>}</font>
<a name='L358'> 358 
<a name='L359'> 359     <b>return</b> <a href='../Y/4140.html' title='Multiple used in 107 places.'>link</a> ? 1 : 0;
<a name='L360'> 360 <font color='red'>}</font>
<a name='L361'> 361 
<a name='L362'> 362 <b>int</b>
<a name='L363'> 363 <a href='../R/3789.html' title='Multiple refered from 2 places.'>of_hw_port_enable_set</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <b>int</b> <a href='../Y/2662.html' title='Multiple used in 11 places.'>enable</a>)
<a name='L364'> 364 <font color='red'>{</font>
<a name='L365'> 365     <b>int</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>;
<a name='L366'> 366 
<a name='L367'> 367     <a href='../S/210.html#L18' title='Defined at 18 in cbench/openflow/hw-lib/skeleton/port.c.'>CHECK_PORT</a>(<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L368'> 368 
<a name='L369'> 369     <b>if</b> ((<a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a> = HW_PORT_ENABLE_SET(<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/5791.html' title='Multiple used in 749 places.'>port</a>, <a href='../Y/2662.html' title='Multiple used in 11 places.'>enable</a>)) &lt; 0) <font color='red'>{</font>
<a name='L370'> 370         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("of_hw_port_enable_set: error %d port %d\n",
<a name='L371'> 371                   <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L372'> 372         <b>return</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>;
<a name='L373'> 373     <font color='red'>}</font>
<a name='L374'> 374 
<a name='L375'> 375     <b>return</b> 0;
<a name='L376'> 376 <font color='red'>}</font>
<a name='L377'> 377 
<a name='L378'> 378 <b>int</b>
<a name='L379'> 379 <a href='../R/3788.html' title='Multiple refered from 2 places.'>of_hw_port_enable_get</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>)
<a name='L380'> 380 <font color='red'>{</font>
<a name='L381'> 381     <b>int</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>;
<a name='L382'> 382     <b>int</b> <a href='../Y/2662.html' title='Multiple used in 11 places.'>enable</a>;
<a name='L383'> 383 
<a name='L384'> 384     <a href='../S/210.html#L18' title='Defined at 18 in cbench/openflow/hw-lib/skeleton/port.c.'>CHECK_PORT</a>(<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L385'> 385 
<a name='L386'> 386     <b>if</b> ((<a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a> = HW_PORT_ENABLE_GET(<a href='../Y/5051.html' title='Multiple used in 18 places.'>of_hw_ports</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/5791.html' title='Multiple used in 749 places.'>port</a>, &amp;<a href='../Y/2662.html' title='Multiple used in 11 places.'>enable</a>)) &lt; 0) <font color='red'>{</font>
<a name='L387'> 387         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("of_hw_port_enable_get: error %d port %d\n",
<a name='L388'> 388                   <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L389'> 389         <b>return</b> <a href='../Y/6257.html' title='Multiple used in 293 places.'>rc</a>;
<a name='L390'> 390     <font color='red'>}</font>
<a name='L391'> 391 
<a name='L392'> 392     <b>return</b> <a href='../Y/2662.html' title='Multiple used in 11 places.'>enable</a> ? 1 : 0;
<a name='L393'> 393 <font color='red'>}</font>
<a name='L394'> 394 
<a name='L395'> 395 
<a name='L396'> 396 <i><font color='green'>/*</font></i>
<a name='L397'> 397 <i><font color='green'> * port_change_register</font></i>
<a name='L398'> 398 <i><font color='green'> *</font></i>
<a name='L399'> 399 <i><font color='green'> * Register a callback function to receive port change notifications</font></i>
<a name='L400'> 400 <i><font color='green'> * from ports in this datapath; only one callback per datapath is</font></i>
<a name='L401'> 401 <i><font color='green'> * supported.</font></i>
<a name='L402'> 402 <i><font color='green'> */</font></i>
<a name='L403'> 403 <b>int</b>
<a name='L404'> 404 <a href='../R/3787.html' title='Multiple refered from 2 places.'>of_hw_port_change_register</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <a href='../Y/5058.html' title='Multiple used in 5 places.'>of_port_change_f</a> <a href='../Y/1775.html' title='Multiple used in 63 places.'>callback</a>,
<a name='L405'> 405                             <b>void</b> *<a href='../Y/2133.html' title='Multiple used in 81 places.'>cookie</a>)
<a name='L406'> 406 <font color='red'>{</font>
<a name='L407'> 407     <a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *<a href='../Y/2523.html' title='Multiple used in 8 places.'>dp_int</a>;
<a name='L408'> 408 
<a name='L409'> 409     <a href='../Y/2523.html' title='Multiple used in 8 places.'>dp_int</a> = (<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *)<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>;
<a name='L410'> 410     <a href='../Y/2523.html' title='Multiple used in 8 places.'>dp_int</a>-&gt;<a href='../Y/5801.html' title='Multiple used in 4 places.'>port_change</a> = <a href='../Y/1775.html' title='Multiple used in 63 places.'>callback</a>;
<a name='L411'> 411     <a href='../Y/2523.html' title='Multiple used in 8 places.'>dp_int</a>-&gt;<a href='../Y/5802.html' title='Multiple used in 3 places.'>port_change_cookie</a> = <a href='../Y/2133.html' title='Multiple used in 81 places.'>cookie</a>;
<a name='L412'> 412 
<a name='L413'> 413     <b>return</b> 0;
<a name='L414'> 414 <font color='red'>}</font>
<a name='L415'> 415 
<a name='L416'> 416 <i><font color='green'>/*</font></i>
<a name='L417'> 417 <i><font color='green'> * Init COS queue setup.  The queues number is fixed at 8.  Deficit</font></i>
<a name='L418'> 418 <i><font color='green'> * round robin is the discipline, initially with all equal weights.</font></i>
<a name='L419'> 419 <i><font color='green'> * As queues are configured with min bandwidth reservations, the</font></i>
<a name='L420'> 420 <i><font color='green'> * weights are adjusted to ensure the requested targets.</font></i>
<a name='L421'> 421 <i><font color='green'> *</font></i>
<a name='L422'> 422 <i><font color='green'> * For now, these are device generic; may need to specialize in the</font></i>
<a name='L423'> 423 <i><font color='green'> * future.</font></i>
<a name='L424'> 424 <i><font color='green'> */</font></i>
<a name='L425'> 425 
<a name='L426'> 426 <b>int</b>
<a name='L427'> 427 <a href='../S/213.html#L25' title='Refered from 25 in cbench/openflow/hw-lib/skeleton/port.h.'>of_hw_cos_setup</a>(<b>int</b> <a href='../Y/4970.html' title='Multiple used in 2 places.'>num_cos</a>)
<a name='L428'> 428 <font color='red'>{</font>
<a name='L429'> 429     <i><font color='green'>/* FIXME: Set up COS queues */</font></i>
<a name='L430'> 430 
<a name='L431'> 431     <b>return</b> 0;
<a name='L432'> 432 <font color='red'>}</font>
<a name='L433'> 433 
<a name='L434'> 434 <i><font color='green'>/*</font></i>
<a name='L435'> 435 <i><font color='green'> * Add and/or configure an output queue on a port.</font></i>
<a name='L436'> 436 <i><font color='green'> *</font></i>
<a name='L437'> 437 <i><font color='green'> * If qid exists, update.  If not, look for an unreferenced queue and</font></i>
<a name='L438'> 438 <i><font color='green'> * set the qid to that value.</font></i>
<a name='L439'> 439 <i><font color='green'> *</font></i>
<a name='L440'> 440 <i><font color='green'> * Note that when a port state changes, may need to re-configure</font></i>
<a name='L441'> 441 <i><font color='green'> * the bandwidth values for the port's queues.</font></i>
<a name='L442'> 442 <i><font color='green'> */</font></i>
<a name='L443'> 443 
<a name='L444'> 444 <b>int</b>
<a name='L445'> 445 <a href='../R/3791.html' title='Multiple refered from 2 places.'>of_hw_port_queue_config</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>,
<a name='L446'> 446                          <b>int</b> <a href='../Y/4452.html' title='Multiple used in 5 places.'>min_bw</a>) <i><font color='green'>/* In tenths of a percent */</font></i>
<a name='L447'> 447 <font color='red'>{</font>
<a name='L448'> 448     <b>int</b> min_kbps;
<a name='L449'> 449     <a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>;
<a name='L450'> 450     <b>int</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L451'> 451     <b>struct</b> <a href='../S/210.html#L41' title='Defined at 41 in cbench/openflow/hw-lib/skeleton/port.c.'>queue_map_s</a> *<a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>;
<a name='L452'> 452     <b>int</b> <a href='../Y/6512.html' title='Multiple used in 34 places.'>rv</a>;
<a name='L453'> 453 
<a name='L454'> 454     <a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a> = (<a href='../S/222.html#L87' title='Defined at 87 in cbench/openflow/hw-lib/skeleton/hw_drv.h.'>of_hw_driver_int_t</a> *)<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>;
<a name='L455'> 455 
<a name='L456'> 456     <a href='../S/210.html#L18' title='Defined at 18 in cbench/openflow/hw-lib/skeleton/port.c.'>CHECK_PORT</a>(<a href='../Y/3690.html' title='Multiple used in 96 places.'>hw_int</a>, <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>);
<a name='L457'> 457 
<a name='L458'> 458     <i><font color='green'>/* LOCK */</font></i>
<a name='L459'> 459     <i><font color='green'>/* Get the current bandwidth of the port (cached?) */</font></i>
<a name='L460'> 460     <b>if</b> ((<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = <a href='../S/210.html#L93' title='Defined at 93 in cbench/openflow/hw-lib/skeleton/port.c.'>qid_find_add</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)) &lt; 0) <font color='red'>{</font>
<a name='L461'> 461         <a href='../D/1142.html' title='Multiple defined in 4 places.'>DBG_ERROR</a>("Could not add queue: of port %d, qid %d\n", <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>);
<a name='L462'> 462         <i><font color='green'>/* UNLOCK */</font></i>
<a name='L463'> 463         <b>return</b> -1;
<a name='L464'> 464     <font color='red'>}</font>
<a name='L465'> 465     <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a> = &amp;<a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6213.html' title='Multiple used in 6 places.'>queue_map</a>[<a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>];
<a name='L466'> 466     <a href='../Y/6193.html' title='Multiple used in 14 places.'>qm</a>-&gt;<a href='../Y/4452.html' title='Multiple used in 5 places.'>min_bw</a> = <a href='../Y/4452.html' title='Multiple used in 5 places.'>min_bw</a>;
<a name='L467'> 467 
<a name='L468'> 468     HW_SET_MIN_BW(...);
<a name='L469'> 469     <i><font color='green'>/* UNLOCK */</font></i>
<a name='L470'> 470 
<a name='L471'> 471     <b>return</b> (<a href='../Y/6512.html' title='Multiple used in 34 places.'>rv</a> != 0) ? -1 : 0;
<a name='L472'> 472 <font color='red'>}</font>
<a name='L473'> 473 
<a name='L474'> 474 <i><font color='green'>/* Remove a queue from a port; this potentially affects the queue</font></i>
<a name='L475'> 475 <i><font color='green'> * configuration otherwise we would not worry about it here.</font></i>
<a name='L476'> 476 <i><font color='green'> * Return -1 if not found; 0 on success</font></i>
<a name='L477'> 477 <i><font color='green'> */</font></i>
<a name='L478'> 478 
<a name='L479'> 479 <b>int</b>
<a name='L480'> 480 <a href='../R/3792.html' title='Multiple refered from 2 places.'>of_hw_port_queue_remove</a>(<a href='../S/183.html#L69' title='Defined at 69 in cbench/openflow/include/openflow/of_hw_api.h.'>of_hw_driver_t</a> *<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>, <b>int</b> <a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)
<a name='L481'> 481 <font color='red'>{</font>
<a name='L482'> 482     <b>int</b> <a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>;
<a name='L483'> 483 
<a name='L484'> 484     (<b>void</b>)<a href='../Y/3685.html' title='Multiple used in 131 places.'>hw_drv</a>;
<a name='L485'> 485     <i><font color='green'>/* LOCK */</font></i>
<a name='L486'> 486     <b>if</b> ((<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a> = <a href='../S/210.html#L58' title='Defined at 58 in cbench/openflow/hw-lib/skeleton/port.c.'>qid_find</a>(<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>, <a href='../Y/6192.html' title='Multiple used in 23 places.'>qid</a>)) == -1) <font color='red'>{</font>
<a name='L487'> 487         <i><font color='green'>/* UNLOCK */</font></i>
<a name='L488'> 488         <b>return</b> -1;
<a name='L489'> 489     <font color='red'>}</font>
<a name='L490'> 490 
<a name='L491'> 491     <i><font color='green'>/* Do we need to update stats or DRR weights or anything? */</font></i>
<a name='L492'> 492 
<a name='L493'> 493     <a href='../Y/5823.html' title='Multiple used in 8 places.'>port_queue</a>[<a href='../Y/5057.html' title='Multiple used in 162 places.'>of_port</a>].<a href='../Y/6213.html' title='Multiple used in 6 places.'>queue_map</a>[<a href='../Y/2141.html' title='Multiple used in 28 places.'>cosq</a>].<a href='../Y/3787.html' title='Multiple used in 15 places.'>in_use</a> = <a href='../Y/2997.html' title='Multiple used in 198 places.'>false</a>;
<a name='L494'> 494 
<a name='L495'> 495     <i><font color='green'>/* UNLOCK */</font></i>
<a name='L496'> 496     <b>return</b> 0;
<a name='L497'> 497 <font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L58'>[^]</a><a href='#L480'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
