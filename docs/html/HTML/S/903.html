<html>
<head>
<title>cbench/openflow/lib/pcap.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/1100.html'>cbench</a>/<a href='../files/1124.html'>openflow</a>/<a href='../files/1140.html'>lib</a>/pcap.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L64'>[^]</a><a href='#L171'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L64' title='Defined at 64.'>pcap_open</a>
<li><a href='#L89' title='Defined at 89.'>pcap_read_header</a>
<li><a href='#L107' title='Defined at 107.'>pcap_write_header</a>
<li><a href='#L123' title='Defined at 123.'>pcap_read</a>
<li><a href='#L171' title='Defined at 171.'>pcap_write</a>
</ol>
<hr>
<pre>
<a name='L1'>   1 <i><font color='green'>/* Copyright (c) 2009 The Board of Trustees of The Leland Stanford</font></i>
<a name='L2'>   2 <i><font color='green'> * Junior University</font></i>
<a name='L3'>   3 <i><font color='green'> *</font></i>
<a name='L4'>   4 <i><font color='green'> * We are making the OpenFlow specification and associated documentation</font></i>
<a name='L5'>   5 <i><font color='green'> * (Software) available for public use and benefit with the expectation</font></i>
<a name='L6'>   6 <i><font color='green'> * that others will use, modify and enhance the Software and contribute</font></i>
<a name='L7'>   7 <i><font color='green'> * those enhancements back to the community. However, since we would</font></i>
<a name='L8'>   8 <i><font color='green'> * like to make the Software available for broadest use, with as few</font></i>
<a name='L9'>   9 <i><font color='green'> * restrictions as possible permission is hereby granted, free of</font></i>
<a name='L10'>  10 <i><font color='green'> * charge, to any person obtaining a copy of this Software to deal in</font></i>
<a name='L11'>  11 <i><font color='green'> * the Software under the copyrights without restriction, including</font></i>
<a name='L12'>  12 <i><font color='green'> * without limitation the rights to use, copy, modify, merge, publish,</font></i>
<a name='L13'>  13 <i><font color='green'> * distribute, sublicense, and/or sell copies of the Software, and to</font></i>
<a name='L14'>  14 <i><font color='green'> * permit persons to whom the Software is furnished to do so, subject to</font></i>
<a name='L15'>  15 <i><font color='green'> * the following conditions:</font></i>
<a name='L16'>  16 <i><font color='green'> *</font></i>
<a name='L17'>  17 <i><font color='green'> * The above copyright notice and this permission notice shall be</font></i>
<a name='L18'>  18 <i><font color='green'> * included in all copies or substantial portions of the Software.</font></i>
<a name='L19'>  19 <i><font color='green'> *</font></i>
<a name='L20'>  20 <i><font color='green'> * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,</font></i>
<a name='L21'>  21 <i><font color='green'> * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</font></i>
<a name='L22'>  22 <i><font color='green'> * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</font></i>
<a name='L23'>  23 <i><font color='green'> * NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS</font></i>
<a name='L24'>  24 <i><font color='green'> * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN</font></i>
<a name='L25'>  25 <i><font color='green'> * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</font></i>
<a name='L26'>  26 <i><font color='green'> * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</font></i>
<a name='L27'>  27 <i><font color='green'> * SOFTWARE.</font></i>
<a name='L28'>  28 <i><font color='green'> *</font></i>
<a name='L29'>  29 <i><font color='green'> * The name and trademarks of copyright holder(s) may NOT be used in</font></i>
<a name='L30'>  30 <i><font color='green'> * advertising or publicity pertaining to the Software or any</font></i>
<a name='L31'>  31 <i><font color='green'> * derivatives without specific, written prior permission.</font></i>
<a name='L32'>  32 <i><font color='green'> */</font></i>
<a name='L33'>  33 
<a name='L34'>  34 <font color='darkred'>#include</font> &lt;<a href='588.html'>config.h</a>&gt;
<a name='L35'>  35 <font color='darkred'>#include</font> "<a href='821.html'>pcap.h</a>"
<a name='L36'>  36 <font color='darkred'>#include</font> &lt;assert.h&gt;
<a name='L37'>  37 <font color='darkred'>#include</font> &lt;errno.h&gt;
<a name='L38'>  38 <font color='darkred'>#include</font> &lt;inttypes.h&gt;
<a name='L39'>  39 <font color='darkred'>#include</font> &lt;string.h&gt;
<a name='L40'>  40 <font color='darkred'>#include</font> "<a href='872.html'>compiler.h</a>"
<a name='L41'>  41 <font color='darkred'>#include</font> "<a href='865.html'>ofpbuf.h</a>"
<a name='L42'>  42 
<a name='L43'>  43 <font color='darkred'>#define</font> <a href='../R/1643.html' title='Multiple refered from 13 places.'>THIS_MODULE</a> VLM_pcap
<a name='L44'>  44 <font color='darkred'>#include</font> "<a href='859.html'>vlog.h</a>"
<a name='L45'>  45 
<a name='L46'>  46 <b>struct</b> <a href='../R/4022.html' title='Multiple refered from 2 places.'>pcap_hdr</a> <font color='red'>{</font>
<a name='L47'>  47     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/4313.html' title='Multiple used in 4 places.'>magic_number</a>;   <i><font color='green'>/* magic number */</font></i>
<a name='L48'>  48     <a href='../Y/7619.html' title='Multiple used in 1069 places.'>uint16_t</a> <a href='../Y/7771.html' title='Multiple used in 7 places.'>version_major</a>;  <i><font color='green'>/* major version number */</font></i>
<a name='L49'>  49     <a href='../Y/7619.html' title='Multiple used in 1069 places.'>uint16_t</a> <a href='../Y/7772.html' title='Multiple used in 5 places.'>version_minor</a>;  <i><font color='green'>/* minor version number */</font></i>
<a name='L50'>  50     int32_t <a href='../Y/7356.html' title='Multiple used in 3 places.'>thiszone</a>;        <i><font color='green'>/* GMT to local correction */</font></i>
<a name='L51'>  51     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6765.html' title='Multiple used in 3 places.'>sigfigs</a>;        <i><font color='green'>/* accuracy of timestamps */</font></i>
<a name='L52'>  52     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/6852.html' title='Multiple used in 12 places.'>snaplen</a>;        <i><font color='green'>/* max length of captured packets */</font></i>
<a name='L53'>  53     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/4739.html' title='Multiple used in 42 places.'>network</a>;        <i><font color='green'>/* data link type */</font></i>
<a name='L54'>  54 <font color='red'>}</font> <a href='../S/872.html#L39' title='Defined at 39 in cbench/openflow/lib/compiler.h.'>PACKED</a>;
<a name='L55'>  55 
<a name='L56'>  56 <b>struct</b> <a href='../R/4029.html' title='Multiple refered from 5 places.'>pcaprec_hdr</a> <font color='red'>{</font>
<a name='L57'>  57     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/7498.html' title='Multiple used in 5 places.'>ts_sec</a>;         <i><font color='green'>/* timestamp seconds */</font></i>
<a name='L58'>  58     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/7500.html' title='Multiple used in 5 places.'>ts_usec</a>;        <i><font color='green'>/* timestamp microseconds */</font></i>
<a name='L59'>  59     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/3791.html' title='Multiple used in 4 places.'>incl_len</a>;       <i><font color='green'>/* number of octets of packet saved in file */</font></i>
<a name='L60'>  60     <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/5514.html' title='Multiple used in 3 places.'>orig_len</a>;       <i><font color='green'>/* actual length of packet */</font></i>
<a name='L61'>  61 <font color='red'>}</font> <a href='../S/872.html#L39' title='Defined at 39 in cbench/openflow/lib/compiler.h.'>PACKED</a>;
<a name='L62'>  62 
<a name='L63'>  63 <a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a> *
<a name='L64'>  64 <a href='../S/821.html#L41' title='Refered from 41 in cbench/openflow/lib/pcap.h.'>pcap_open</a>(<b>const</b> <b>char</b> *<a href='../Y/3051.html' title='Multiple used in 50 places.'>file_name</a>, <b>const</b> <b>char</b> *<a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>)
<a name='L65'>  65 <font color='red'>{</font>
<a name='L66'>  66     <a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a> *<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>;
<a name='L67'>  67 
<a name='L68'>  68     <a href='../Y/1502.html' title='Multiple used in 179 places.'>assert</a>(!<a href='../Y/7082.html' title='Multiple used in 371 places.'>strcmp</a>(<a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>, "rb") || !<a href='../Y/7082.html' title='Multiple used in 371 places.'>strcmp</a>(<a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>, "wb"));
<a name='L69'>  69 
<a name='L70'>  70     <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a> = <a href='../Y/3190.html' title='Multiple used in 43 places.'>fopen</a>(<a href='../Y/3051.html' title='Multiple used in 50 places.'>file_name</a>, <a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>);
<a name='L71'>  71     <b>if</b> (<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a> == <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>) <font color='red'>{</font>
<a name='L72'>  72         <a href='../S/859.html#L151' title='Defined at 151 in cbench/openflow/lib/vlog.h.'>VLOG_WARN</a>("%s: failed to open pcap file for %s",
<a name='L73'>  73                   <a href='../Y/3051.html' title='Multiple used in 50 places.'>file_name</a>, <a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>[0] == 'r' ? "reading" : "writing");
<a name='L74'>  74         <b>return</b> <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>;
<a name='L75'>  75     <font color='red'>}</font>
<a name='L76'>  76 
<a name='L77'>  77     <b>if</b> (<a href='../Y/4483.html' title='Multiple used in 57 places.'>mode</a>[0] == 'r') <font color='red'>{</font>
<a name='L78'>  78         <b>if</b> (!<a href='../S/903.html#L89' title='Defined at 89 in cbench/openflow/lib/pcap.c.'>pcap_read_header</a>(<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>)) <font color='red'>{</font>
<a name='L79'>  79             <a href='../Y/3012.html' title='Multiple used in 34 places.'>fclose</a>(<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>);
<a name='L80'>  80             <b>return</b> <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>;
<a name='L81'>  81         <font color='red'>}</font>
<a name='L82'>  82     <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L83'>  83         <a href='../S/903.html#L107' title='Defined at 107 in cbench/openflow/lib/pcap.c.'>pcap_write_header</a>(<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>);
<a name='L84'>  84     <font color='red'>}</font>
<a name='L85'>  85     <b>return</b> <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>;
<a name='L86'>  86 <font color='red'>}</font>
<a name='L87'>  87 
<a name='L88'>  88 <b>int</b>
<a name='L89'>  89 <a href='../R/4025.html' title='Multiple refered from 3 places.'>pcap_read_header</a>(<a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a> *<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>)
<a name='L90'>  90 <font color='red'>{</font>
<a name='L91'>  91     <b>struct</b> <a href='../D/9016.html' title='Multiple defined in 2 places.'>pcap_hdr</a> <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>;
<a name='L92'>  92     <b>if</b> (<a href='../Y/3232.html' title='Multiple used in 6 places.'>fread</a>(&amp;<a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>, <b>sizeof</b> <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>, 1, <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>) != 1) <font color='red'>{</font>
<a name='L93'>  93         <b>int</b> <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a> = <a href='../Y/3027.html' title='Multiple used in 7 places.'>ferror</a>(<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>) ? <a href='../Y/2760.html' title='Multiple used in 228 places.'>errno</a> : <a href='../Y/281.html' title='Multiple used in 14 places.'>EOF</a>;
<a name='L94'>  94         <a href='../S/859.html#L151' title='Defined at 151 in cbench/openflow/lib/vlog.h.'>VLOG_WARN</a>("failed to read pcap header: %s",
<a name='L95'>  95                   <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a> &gt; 0 ? <a href='../Y/7090.html' title='Multiple used in 143 places.'>strerror</a>(<a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a>) : "end of file");
<a name='L96'>  96         <b>return</b> <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a>;
<a name='L97'>  97     <font color='red'>}</font>
<a name='L98'>  98     <b>if</b> (<a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/4313.html' title='Multiple used in 4 places.'>magic_number</a> != 0xa1b2c3d4 &amp;&amp; <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/4313.html' title='Multiple used in 4 places.'>magic_number</a> != 0xd4c3b2a1) <font color='red'>{</font>
<a name='L99'>  99         <a href='../S/859.html#L151' title='Defined at 151 in cbench/openflow/lib/vlog.h.'>VLOG_WARN</a>("bad magic 0x%08"<a href='../Y/702.html' title='Multiple used in 15 places.'>PRIx32</a>" reading pcap file "
<a name='L100'> 100                   "(expected 0xa1b2c3d4 or 0xd4c3b2a1)", <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/4313.html' title='Multiple used in 4 places.'>magic_number</a>);
<a name='L101'> 101         <b>return</b> <a href='../Y/291.html' title='Multiple used in 24 places.'>EPROTO</a>;
<a name='L102'> 102     <font color='red'>}</font>
<a name='L103'> 103     <b>return</b> 0;
<a name='L104'> 104 <font color='red'>}</font>
<a name='L105'> 105 
<a name='L106'> 106 <b>void</b>
<a name='L107'> 107 <a href='../R/4027.html' title='Multiple refered from 3 places.'>pcap_write_header</a>(<a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a> *<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>)
<a name='L108'> 108 <font color='red'>{</font>
<a name='L109'> 109     <i><font color='green'>/* The pcap reader is responsible for figuring out endianness based on the</font></i>
<a name='L110'> 110 <i><font color='green'>     * magic number, so the lack of htonX calls here is intentional. */</font></i>
<a name='L111'> 111     <b>struct</b> <a href='../D/9016.html' title='Multiple defined in 2 places.'>pcap_hdr</a> <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>;
<a name='L112'> 112     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/4313.html' title='Multiple used in 4 places.'>magic_number</a> = 0xa1b2c3d4;
<a name='L113'> 113     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/7771.html' title='Multiple used in 7 places.'>version_major</a> = 2;
<a name='L114'> 114     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/7772.html' title='Multiple used in 5 places.'>version_minor</a> = 4;
<a name='L115'> 115     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/7356.html' title='Multiple used in 3 places.'>thiszone</a> = 0;
<a name='L116'> 116     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/6765.html' title='Multiple used in 3 places.'>sigfigs</a> = 0;
<a name='L117'> 117     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/6852.html' title='Multiple used in 12 places.'>snaplen</a> = 1518;
<a name='L118'> 118     <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>.<a href='../Y/4739.html' title='Multiple used in 42 places.'>network</a> = 1;             <i><font color='green'>/* Ethernet */</font></i>
<a name='L119'> 119     <a href='../Y/3289.html' title='Multiple used in 5 places.'>fwrite</a>(&amp;<a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>, <b>sizeof</b> <a href='../Y/5726.html' title='Multiple used in 13 places.'>ph</a>, 1, <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>);
<a name='L120'> 120 <font color='red'>}</font>
<a name='L121'> 121 
<a name='L122'> 122 <b>int</b>
<a name='L123'> 123 <a href='../R/4024.html' title='Multiple refered from 2 places.'>pcap_read</a>(<a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a> *<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>, <b>struct</b> <a href='../Y/5376.html' title='Multiple used in 231 places.'>ofpbuf</a> **<a href='../Y/1714.html' title='Multiple used in 6 places.'>bufp</a>)
<a name='L124'> 124 <font color='red'>{</font>
<a name='L125'> 125     <b>struct</b> <a href='../D/9023.html' title='Multiple defined in 2 places.'>pcaprec_hdr</a> <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>;
<a name='L126'> 126     <b>struct</b> <a href='../S/865.html#L41' title='Defined at 41 in cbench/openflow/lib/ofpbuf.h.'>ofpbuf</a> *<a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>;
<a name='L127'> 127     <b>void</b> *<a href='../Y/2247.html' title='Multiple used in 1185 places.'>data</a>;
<a name='L128'> 128     <a href='../Y/6800.html' title='Multiple used in 615 places.'>size_t</a> <a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a>;
<a name='L129'> 129 
<a name='L130'> 130     *<a href='../Y/1714.html' title='Multiple used in 6 places.'>bufp</a> = <a href='../Y/603.html' title='Multiple used in 2170 places.'>NULL</a>;
<a name='L131'> 131 
<a name='L132'> 132     <i><font color='green'>/* Read header. */</font></i>
<a name='L133'> 133     <b>if</b> (<a href='../Y/3232.html' title='Multiple used in 6 places.'>fread</a>(&amp;<a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>, <b>sizeof</b> <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>, 1, <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>) != 1) <font color='red'>{</font>
<a name='L134'> 134         <b>int</b> <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a> = <a href='../Y/3027.html' title='Multiple used in 7 places.'>ferror</a>(<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>) ? <a href='../Y/2760.html' title='Multiple used in 228 places.'>errno</a> : <a href='../Y/281.html' title='Multiple used in 14 places.'>EOF</a>;
<a name='L135'> 135         <a href='../S/859.html#L151' title='Defined at 151 in cbench/openflow/lib/vlog.h.'>VLOG_WARN</a>("failed to read pcap record header: %s",
<a name='L136'> 136                   <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a> &gt; 0 ? <a href='../Y/7090.html' title='Multiple used in 143 places.'>strerror</a>(<a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a>) : "end of file");
<a name='L137'> 137         <b>return</b> <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a>;
<a name='L138'> 138     <font color='red'>}</font>
<a name='L139'> 139 
<a name='L140'> 140     <i><font color='green'>/* Calculate length. */</font></i>
<a name='L141'> 141     <a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> = <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>.<a href='../Y/3791.html' title='Multiple used in 4 places.'>incl_len</a>;
<a name='L142'> 142     <b>if</b> (<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> &gt; 0xffff) <font color='red'>{</font>
<a name='L143'> 143         <a href='../Y/7621.html' title='Multiple used in 1429 places.'>uint32_t</a> <a href='../Y/7190.html' title='Multiple used in 4 places.'>swapped_len</a> = (((<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> &amp; 0xff000000) &gt;&gt; 24) |
<a name='L144'> 144                                 ((<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> &amp; 0x00ff0000) &gt;&gt;  8) |
<a name='L145'> 145                                 ((<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> &amp; 0x0000ff00) &lt;&lt;  8) |
<a name='L146'> 146                                 ((<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> &amp; 0x000000ff) &lt;&lt; 24));
<a name='L147'> 147         <b>if</b> (<a href='../Y/7190.html' title='Multiple used in 4 places.'>swapped_len</a> &gt; 0xffff) <font color='red'>{</font>
<a name='L148'> 148             <a href='../S/859.html#L151' title='Defined at 151 in cbench/openflow/lib/vlog.h.'>VLOG_WARN</a>("bad packet length %"<a href='../Y/698.html' title='Multiple used in 15 places.'>PRIu32</a>" or %"<a href='../Y/698.html' title='Multiple used in 15 places.'>PRIu32</a>" "
<a name='L149'> 149                       "reading pcap file",
<a name='L150'> 150                       <a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a>, <a href='../Y/7190.html' title='Multiple used in 4 places.'>swapped_len</a>);
<a name='L151'> 151             <b>return</b> <a href='../Y/291.html' title='Multiple used in 24 places.'>EPROTO</a>;
<a name='L152'> 152         <font color='red'>}</font>
<a name='L153'> 153         <a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a> = <a href='../Y/7190.html' title='Multiple used in 4 places.'>swapped_len</a>;
<a name='L154'> 154     <font color='red'>}</font>
<a name='L155'> 155 
<a name='L156'> 156     <i><font color='green'>/* Read packet. */</font></i>
<a name='L157'> 157     <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a> = <a href='../S/887.html#L87' title='Defined at 87 in cbench/openflow/lib/ofpbuf.c.'>ofpbuf_new</a>(<a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a>);
<a name='L158'> 158     <a href='../Y/2247.html' title='Multiple used in 1185 places.'>data</a> = <a href='../S/887.html#L175' title='Defined at 175 in cbench/openflow/lib/ofpbuf.c.'>ofpbuf_put_uninit</a>(<a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>, <a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a>);
<a name='L159'> 159     <b>if</b> (<a href='../Y/3232.html' title='Multiple used in 6 places.'>fread</a>(<a href='../Y/2247.html' title='Multiple used in 1185 places.'>data</a>, <a href='../Y/4119.html' title='Multiple used in 983 places.'>len</a>, 1, <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>) != 1) <font color='red'>{</font>
<a name='L160'> 160         <b>int</b> <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a> = <a href='../Y/3027.html' title='Multiple used in 7 places.'>ferror</a>(<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>) ? <a href='../Y/2760.html' title='Multiple used in 228 places.'>errno</a> : <a href='../Y/281.html' title='Multiple used in 14 places.'>EOF</a>;
<a name='L161'> 161         <a href='../S/859.html#L151' title='Defined at 151 in cbench/openflow/lib/vlog.h.'>VLOG_WARN</a>("failed to read pcap packet: %s",
<a name='L162'> 162                   <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a> &gt; 0 ? <a href='../Y/7090.html' title='Multiple used in 143 places.'>strerror</a>(<a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a>) : "end of file");
<a name='L163'> 163         <a href='../S/887.html#L110' title='Defined at 110 in cbench/openflow/lib/ofpbuf.c.'>ofpbuf_delete</a>(<a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>);
<a name='L164'> 164         <b>return</b> <a href='../Y/2762.html' title='Multiple used in 572 places.'>error</a>;
<a name='L165'> 165     <font color='red'>}</font>
<a name='L166'> 166     *<a href='../Y/1714.html' title='Multiple used in 6 places.'>bufp</a> = <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>;
<a name='L167'> 167     <b>return</b> 0;
<a name='L168'> 168 <font color='red'>}</font>
<a name='L169'> 169 
<a name='L170'> 170 <b>void</b>
<a name='L171'> 171 <a href='../R/4026.html' title='Multiple refered from 2 places.'>pcap_write</a>(<a href='../Y/328.html' title='Multiple used in 113 places.'>FILE</a> *<a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>, <b>struct</b> <a href='../Y/5376.html' title='Multiple used in 231 places.'>ofpbuf</a> *<a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>)
<a name='L172'> 172 <font color='red'>{</font>
<a name='L173'> 173     <b>struct</b> <a href='../D/9023.html' title='Multiple defined in 2 places.'>pcaprec_hdr</a> <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>;
<a name='L174'> 174     <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>.<a href='../Y/7498.html' title='Multiple used in 5 places.'>ts_sec</a> = 0;
<a name='L175'> 175     <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>.<a href='../Y/7500.html' title='Multiple used in 5 places.'>ts_usec</a> = 0;
<a name='L176'> 176     <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>.<a href='../Y/3791.html' title='Multiple used in 4 places.'>incl_len</a> = <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>-&gt;<a href='../Y/6799.html' title='Multiple used in 476 places.'>size</a>;
<a name='L177'> 177     <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>.<a href='../Y/5514.html' title='Multiple used in 3 places.'>orig_len</a> = <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>-&gt;<a href='../Y/6799.html' title='Multiple used in 476 places.'>size</a>;
<a name='L178'> 178     <a href='../Y/3289.html' title='Multiple used in 5 places.'>fwrite</a>(&amp;<a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>, <b>sizeof</b> <a href='../Y/5888.html' title='Multiple used in 9 places.'>prh</a>, 1, <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>);
<a name='L179'> 179     <a href='../Y/3289.html' title='Multiple used in 5 places.'>fwrite</a>(<a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>-&gt;<a href='../Y/2247.html' title='Multiple used in 1185 places.'>data</a>, <a href='../Y/1693.html' title='Multiple used in 469 places.'>buf</a>-&gt;<a href='../Y/6799.html' title='Multiple used in 476 places.'>size</a>, 1, <a href='../Y/3043.html' title='Multiple used in 106 places.'>file</a>);
<a name='L180'> 180 <font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L64'>[^]</a><a href='#L171'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
